# 上线测试清单

**版本**: v5.1.1  
**更新时间**: 2025-01-18  
**负责人**: 开发团队

---

## 📋 P5-1: 全面测试清单

### 1. 功能测试

#### 1.1 报告生成流程
- [ ] **基础报告生成** (免费)
  - [ ] 输入有效八字数据 → 生成完整基础报告
  - [ ] 报告包含封面、四柱展示、五行雷达、性格摘要、风水预览
  - [ ] Paywall正确显示，卖点清晰
  - [ ] 响应时间 <3秒
  - [ ] 成本 <$0.02
  
- [ ] **精华报告生成** (付费)
  - [ ] 解锁后正确生成完整报告
  - [ ] 包含人宅合一分析（超吉位、风险区、布局建议）
  - [ ] 所有主题(5-8个)完整渲染
  - [ ] PDF导出功能正常
  - [ ] 响应时间 <8秒
  - [ ] 成本 <$0.50

#### 1.2 AI分析质量
- [ ] **人宅合一分析**
  - [ ] 超吉位推荐准确（1-3个）
  - [ ] 风险区检测合理（0-2个）
  - [ ] 布局建议可执行（3-5条）
  - [ ] 无重复内容
  - [ ] 无占位符(PLACEHOLDER)
  
- [ ] **合规性检查**
  - [ ] 无敏感词汇（14个违禁词）
  - [ ] 无夸张承诺
  - [ ] 免责声明正确显示

#### 1.3 支付流程
- [ ] 点击"解锁报告"正确跳转支付页面
- [ ] 支付金额显示正确（¥9.90）
- [ ] 支付成功后自动解锁报告
- [ ] 支付失败显示友好错误信息
- [ ] 订单记录正确保存

#### 1.4 用户体验
- [ ] 加载状态正确显示
- [ ] 错误处理友好（网络错误、数据错误、超时）
- [ ] 移动端响应式布局正常
- [ ] 页面滚动流畅（无卡顿）
- [ ] 交互反馈及时（按钮点击、表单验证）

---

### 2. 性能测试

#### 2.1 响应时间
| 操作 | 目标时间 | 实测时间 | 通过 |
|------|----------|----------|------|
| 页面加载 | <2s | ⏱️ | ⬜ |
| 基础报告生成 | <3s | ⏱️ | ⬜ |
| 精华报告生成 | <8s | ⏱️ | ⬜ |
| PDF生成 | <5s | ⏱️ | ⬜ |
| 支付跳转 | <1s | ⏱️ | ⬜ |

#### 2.2 资源使用
- [ ] 页面包大小 <500KB (gzip)
- [ ] 图片优化（WebP格式）
- [ ] 无内存泄漏（长时间使用）
- [ ] CPU使用率正常（<50%）

#### 2.3 并发测试
- [ ] 10并发用户正常服务
- [ ] 50并发用户无明显延迟
- [ ] 100并发用户（压力测试）

---

### 3. 安全测试

#### 3.1 数据安全
- [ ] 用户输入数据加密传输（HTTPS）
- [ ] 敏感信息不存储在localStorage
- [ ] API密钥不暴露到前端
- [ ] SQL注入防护（如适用）
- [ ] XSS攻击防护

#### 3.2 身份认证
- [ ] 未登录用户只能生成基础报告
- [ ] 支付验证正确（防止绕过）
- [ ] Session超时处理合理

#### 3.3 合规性
- [ ] 18岁以上年龄验证
- [ ] 免责声明用户必须同意
- [ ] 隐私政策显示并可访问
- [ ] GDPR/CCPA合规（如适用）

---

### 4. 成本控制测试

#### 4.1 Token使用
- [ ] 基础报告：<500 tokens
- [ ] 精华报告：<2500 tokens
- [ ] Token计数器准确记录
- [ ] 成本守卫正确拦截超限请求

#### 4.2 降级策略
- [ ] 成本接近限制时自动使用缓存
- [ ] 超出每小时限制时降级到模板
- [ ] 超出每日限制时拒绝新请求
- [ ] 降级过程用户体验友好

#### 4.3 预警系统
- [ ] 达到50%限制触发INFO级别预警
- [ ] 达到75%限制触发WARNING级别预警
- [ ] 达到90%限制触发CRITICAL级别预警
- [ ] 预警通知渠道正常（日志/邮件）

---

### 5. 转化率优化测试

#### 5.1 Paywall A/B测试
- [ ] 4个变体正确显示（default, urgency, value, social_proof）
- [ ] 用户分配随机且稳定（同一用户看到相同变体）
- [ ] 流量分配均匀（各25%）
- [ ] 追踪数据正确记录

#### 5.2 转化追踪
- [ ] page_view事件正确触发
- [ ] report_generated事件正确触发
- [ ] paywall_shown事件正确触发
- [ ] payment_initiated/completed事件正确触发
- [ ] 转化漏斗数据计算准确

---

### 6. 浏览器兼容性

| 浏览器 | 版本 | 通过 |
|--------|------|------|
| Chrome | 最新 | ⬜ |
| Firefox | 最新 | ⬜ |
| Safari | 最新 | ⬜ |
| Edge | 最新 | ⬜ |
| 移动Safari (iOS) | iOS 14+ | ⬜ |
| 移动Chrome (Android) | Android 10+ | ⬜ |

---

### 7. 集成测试

#### 7.1 第三方服务
- [ ] DeepSeek API连接正常
- [ ] 支付服务集成正常
- [ ] 数据库读写正常
- [ ] CDN资源加载正常

#### 7.2 监控与日志
- [ ] 错误日志正确记录
- [ ] 性能指标正确收集
- [ ] 用户行为追踪正常
- [ ] 告警通知渠道畅通

---

### 8. 边界测试

#### 8.1 异常输入
- [ ] 空输入处理
- [ ] 无效日期处理
- [ ] 特殊字符输入
- [ ] 超长文本输入

#### 8.2 网络异常
- [ ] 网络断开时的友好提示
- [ ] API超时重试机制
- [ ] 降级到缓存数据

#### 8.3 并发冲突
- [ ] 同一用户多次生成报告
- [ ] 同一订单重复支付
- [ ] 资源竞争处理

---

## ✅ 测试完成标准

- [ ] **所有核心功能测试通过率 >95%**
- [ ] **性能指标全部达标**
- [ ] **无P0/P1级别bug**
- [ ] **成本控制测试全部通过**
- [ ] **安全测试无重大漏洞**
- [ ] **至少2名测试人员签署确认**

---

## 📝 测试记录

| 日期 | 测试人员 | 通过项 | 失败项 | 备注 |
|------|----------|--------|--------|------|
| 2025-01-__ | ___ | __/__ | __/__ | ___ |
| 2025-01-__ | ___ | __/__ | __/__ | ___ |

---

## 🐛 已知问题

| ID | 严重程度 | 问题描述 | 状态 | 责任人 |
|----|----------|----------|------|--------|
| BUG-001 | P2 | ___ | 待修复 | ___ |
| BUG-002 | P3 | ___ | 已修复 | ___ |

---

**下一步**: 完成所有测试后，进入P5-2性能优化检查
