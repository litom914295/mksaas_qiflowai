{
  "metadata": {
    "version": "1.0.0",
    "generatedAt": "2025-01-03T04:00:00Z",
    "source": "@PRD_AI_BAZI_v5.1.1.md",
    "projectName": "AI Bazi Fengshui Platform"
  },
  "tags": {
    "qiflowai-migration": {
      "tasks": [
        {
          "id": "1",
          "title": "首页设计与开发（Hero + Features + Pricing）",
          "status": "done",
          "priority": "high",
          "description": "完成首页核心模块：Hero 区、功能介绍、如何运作、计费套餐、信任合规、Footer，支持 i18n。",
          "details": "已完成：Hero Section、Features、How It Works、Pricing、Compliance、Footer 均已接入 next-intl（zh-CN/en），品牌 Logo/图标占位到位。",
          "acceptanceCriteria": [
            "Hero 区显示主标题/副标题/CTA，响应式",
            "三个功能卡片可点击跳转",
            "计费套餐显示积分包与功能计费表",
            "信任合规四项内容清晰展示",
            "Footer 含关于我们/快速链接/核心功能/关注我们",
            "i18n 支持 zh-CN/en 切换"
          ],
          "testStrategy": "Playwright E2E 测试 CTA 与品牌资源可访问性",
          "dependencies": []
        },
        {
          "id": "2",
          "title": "国际化（next-intl）全面落地",
          "status": "done",
          "priority": "high",
          "description": "为首页所有区域接入 i18n，补充 homeV2 文案（zh-CN/en）。",
          "details": "Hero、Features、HowItWorks、Pricing、Compliance、Footer 全部接入 getTranslations('homeV2.*')。",
          "acceptanceCriteria": [
            "所有静态文案均从 locales/zh-CN.json 与 en.json 读取",
            "语言切换后所有内容正确翻译",
            "不遗留硬编码中文/英文字符串"
          ],
          "testStrategy": "手动切换语言验证，Playwright 断言关键文案存在",
          "dependencies": ["1"]
        },
        {
          "id": "3",
          "title": "品牌资源设计与占位（Logo + Icons）",
          "status": "done",
          "priority": "medium",
          "description": "创建品牌 Logo 与核心图标 SVG（八卦/罗盘/AI/盾牌/闪电），支持深浅色模式。",
          "details": "已创建 /public/brand/logo.svg 与 icons/bagua.svg、luopan.svg、ai.svg、shield.svg、lightning.svg。",
          "acceptanceCriteria": [
            "SVG 格式清晰，支持缩放",
            "图标在 Hero 与 Features 正确显示",
            "占位 SVG 可后续替换为设计定稿版"
          ],
          "testStrategy": "手动检查图标显示，E2E 测试资源可访问性",
          "dependencies": []
        },
        {
          "id": "4",
          "title": "四态组件开发（Empty/Error/Limited/Timeout）",
          "status": "done",
          "priority": "high",
          "description": "创建通用 FourStateShell 组件，支持四种状态展示与重试/升级按钮。",
          "details": "已创建 components/common/four-state-shell.tsx，支持 state 参数切换四态。",
          "acceptanceCriteria": [
            "Empty 态显示 \"还没有开始\"",
            "Error 态显示 \"服务暂不可用\"",
            "Limited 态显示 \"功能受限\" 并提供升级按钮",
            "Timeout 态显示 \"分析超时\"",
            "重试按钮跳转正确",
            "i18n 支持"
          ],
          "testStrategy": "通过 ?state=empty|error|limited|timeout 参数测试各态",
          "dependencies": ["2"]
        },
        {
          "id": "5",
          "title": "引导条组件开发（GuidanceBanner）",
          "status": "done",
          "priority": "medium",
          "description": "创建通用引导条组件，根据页面类型显示文案与图标。",
          "details": "已创建 components/common/guidance-banner.tsx，支持 bazi/compass/chat 类型。",
          "acceptanceCriteria": [
            "引导条显示对应图标（八卦/罗盘/AI）",
            "文案从 i18n 读取",
            "样式与品牌色调一致"
          ],
          "testStrategy": "在三个落地页中验证引导条显示",
          "dependencies": ["3"]
        },
        {
          "id": "6",
          "title": "bazi-analysis 落地页改造（引导+四态）",
          "status": "done",
          "priority": "high",
          "description": "为 /[locale]/bazi-analysis 接入 GuidanceBanner 与 FourStateShell。",
          "details": "已修改 page.tsx，支持 ?state 参数，默认 ok。",
          "acceptanceCriteria": [
            "引导条显示 \"填写出生信息\"",
            "四态切换正常",
            "默认 ok 态显示 BaziAnalysisPage 组件"
          ],
          "testStrategy": "访问 /zh-CN/bazi-analysis?state=empty 等参数验证",
          "dependencies": ["4", "5"]
        },
        {
          "id": "7",
          "title": "chat 落地页改造（引导+四态）",
          "status": "done",
          "priority": "high",
          "description": "为 /[locale]/chat 接入 GuidanceBanner 与 FourStateShell。",
          "details": "已修改 page.tsx，支持 ?state 参数，默认 ok。",
          "acceptanceCriteria": [
            "引导条显示 \"实时 AI 咨询\"",
            "四态切换正常",
            "默认 ok 态显示 EnhancedChatInterface 组件"
          ],
          "testStrategy": "访问 /zh-CN/chat?state=limited 等参数验证",
          "dependencies": ["4", "5"]
        },
        {
          "id": "8",
          "title": "compass-analysis 落地页创建（引导+四态）",
          "status": "done",
          "priority": "high",
          "description": "新建 /[locale]/compass-analysis 页面，接入 GuidanceBanner 与 FourStateShell。",
          "details": "已创建 page.tsx，提供 \"查看示例结果\" 与 \"打开测试页面\" 按钮。",
          "acceptanceCriteria": [
            "引导条显示 \"输入地址或使用数字罗盘\"",
            "四态切换正常",
            "默认 ok 态显示占位内容与跳转按钮"
          ],
          "testStrategy": "访问 /zh-CN/compass-analysis?state=error 等参数验证",
          "dependencies": ["4", "5"]
        },
        {
          "id": "9",
          "title": "E2E 测试覆盖（Playwright）",
          "status": "done",
          "priority": "medium",
          "description": "编写 Playwright E2E 测试，覆盖首页关键文案/CTA/品牌资源。",
          "details": "已创建 tests/e2e/home.spec.ts，检查 Hero 文案、CTA 按钮、SVG 可访问性、功能卡片导航。",
          "acceptanceCriteria": [
            "测试通过：Hero 标题可见",
            "测试通过：CTA 按钮可见",
            "测试通过：品牌 SVG 可访问（200 OK）",
            "测试通过：功能卡片导航至 bazi-analysis"
          ],
          "testStrategy": "npx playwright test 命令执行",
          "dependencies": ["1", "3"]
        },
        {
          "id": "10",
          "title": "Shadcn UI 接入（Button/Card）",
          "status": "pending",
          "priority": "medium",
          "description": "将首页 CTA 按钮与功能卡片替换为 Shadcn UI 组件。",
          "details": "安装 @shadcn/ui，创建 Button、Card 组件，替换原生 HTML 元素。",
          "acceptanceCriteria": [
            "CTA 按钮使用 Shadcn Button 组件",
            "功能卡片使用 Shadcn Card 组件",
            "样式保持一致或更优",
            "Hover 交互保留"
          ],
          "testStrategy": "手动检查样式与交互，E2E 测试不回归",
          "dependencies": ["1"]
        },
        {
          "id": "11",
          "title": "深色模式支持（Dark Mode）",
          "status": "pending",
          "priority": "low",
          "description": "为首页与落地页添加深色模式支持，响应 prefers-color-scheme 或主题切换。",
          "details": "在 Tailwind 配置 dark: 前缀，为关键元素添加深色样式。",
          "acceptanceCriteria": [
            "浅色模式正常显示",
            "深色模式背景/文字/渐变自适应",
            "主题切换按钮（如有）正常工作"
          ],
          "testStrategy": "手动切换系统主题验证",
          "dependencies": ["1"]
        },
        {
          "id": "12",
          "title": "Logo 深浅色双版本与自适应",
          "status": "pending",
          "priority": "low",
          "description": "创建 logo-dark.svg，并在布局或组件中按主题自动切换。",
          "details": "新增 /public/brand/logo-dark.svg，修改 Header/Hero 使用条件渲染或 CSS filter。",
          "acceptanceCriteria": [
            "浅色模式显示 logo.svg",
            "深色模式显示 logo-dark.svg 或 filter: invert",
            "切换流畅无闪烁"
          ],
          "testStrategy": "手动切换主题验证 Logo 显示",
          "dependencies": ["11"]
        },
        {
          "id": "13",
          "title": "响应式优化（Mobile/Tablet/Desktop）",
          "status": "pending",
          "priority": "medium",
          "description": "确保首页与落地页在移动端/平板/桌面均良好显示。",
          "details": "使用 Tailwind 断点（sm:/md:/lg:）调整布局、字体、间距。",
          "acceptanceCriteria": [
            "移动端（<640px）单列布局，字体适中",
            "平板（640-1024px）双列或三列布局",
            "桌面（>1024px）最大宽度限制，居中显示",
            "CTA 按钮在小屏幕竖向排列"
          ],
          "testStrategy": "Chrome DevTools 设备模拟，Playwright viewport 测试",
          "dependencies": ["1"]
        },
        {
          "id": "14",
          "title": "性能优化（LCP/CLS/INP）",
          "status": "pending",
          "priority": "high",
          "description": "优化首页加载性能，确保 Core Web Vitals 达标。",
          "details": "RSC 优化、图片懒加载、Suspense 边界、字体优化、代码分割。",
          "acceptanceCriteria": [
            "LCP < 2.5s",
            "CLS < 0.1",
            "INP < 200ms",
            "Lighthouse Performance 评分 > 90"
          ],
          "testStrategy": "Lighthouse CI 集成，PageSpeed Insights 验证",
          "dependencies": ["1"]
        },
        {
          "id": "15",
          "title": "SEO 优化（Metadata/Sitemap/Robots）",
          "status": "pending",
          "priority": "medium",
          "description": "为首页与落地页添加 SEO 元数据、sitemap.xml、robots.txt。",
          "details": "使用 Next.js generateMetadata 动态生成 title/description/og:image，生成 sitemap 与 robots。",
          "acceptanceCriteria": [
            "首页 title/description 正确",
            "OG 标签完整",
            "sitemap.xml 包含所有页面",
            "robots.txt 允许索引"
          ],
          "testStrategy": "手动检查页面源码，Google Search Console 验证",
          "dependencies": ["1"]
        },
        {
          "id": "16",
          "title": "积分与计费逻辑实现（后端集成）",
          "status": "pending",
          "priority": "high",
          "description": "实现积分购买、消耗、余额查询、三级降级逻辑。",
          "details": "后端 API 接口开发，前端页面集成（充值页/积分显示/受限态触发）。",
          "acceptanceCriteria": [
            "用户可购买积分包",
            "功能调用时扣除对应积分",
            "余额不足触发 Limited 态并引导充值",
            "三级降级策略正确执行"
          ],
          "testStrategy": "Mock 积分余额测试降级逻辑，集成测试完整流程",
          "dependencies": ["4"]
        },
        {
          "id": "17",
          "title": "合规功能实现（18+/免责/DSAR/敏感主题拒答）",
          "status": "pending",
          "priority": "high",
          "description": "实现 18+ 年龄验证、免责声明弹窗、DSAR 申请入口、AI 敏感主题拒答。",
          "details": "注册时验证年龄，首次使用弹出免责声明，Profile 页面提供 DSAR 入口，Chat 组件拒答敏感问题。",
          "acceptanceCriteria": [
            "注册时验证年龄 >= 18",
            "首次访问显示免责声明弹窗，用户需勾选同意",
            "Profile 页面有 DSAR 申请按钮",
            "AI Chat 拒答法律/医疗/投资/政治敏感问题"
          ],
          "testStrategy": "手动测试注册流程/弹窗/DSAR，Chat 输入敏感问题验证",
          "dependencies": []
        },
        {
          "id": "18",
          "title": "监控与日志（Sentry/Analytics）",
          "status": "pending",
          "priority": "low",
          "description": "接入 Sentry 错误监控与 Google Analytics 埋点。",
          "details": "安装 @sentry/nextjs，配置 Sentry DSN，接入 GA4，埋点关键事件（CTA 点击/充值/功能调用）。",
          "acceptanceCriteria": [
            "Sentry 捕获前端错误",
            "GA4 追踪页面浏览与事件",
            "关键事件（CTA/充值/功能调用）埋点完整"
          ],
          "testStrategy": "触发错误验证 Sentry，手动点击 CTA 验证 GA4 事件",
          "dependencies": []
        }
      ]
    }
  }
}
