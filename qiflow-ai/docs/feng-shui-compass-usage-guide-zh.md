# 风水罗盘组件使用指南

## 快速开始

### 1. 访问测试页面
打开浏览器访问：
```
http://localhost:3000/en/test-guest
```

### 2. 基本操作
1. **查看罗盘**: 页面加载后自动显示风水罗盘
2. **调整配置**: 使用右侧配置面板调整罗盘参数
3. **启用传感器**: 勾选"启用传感器"获取设备方向数据
4. **AI分析**: 勾选"启用AI分析"获取智能建议

## 功能详解

### 罗盘主体功能

#### 1. 传统风水元素
- **八卦显示**: 乾、坤、震、巽、坎、离、艮、兑
- **二十四山**: 完整的24个方位山向
- **透地六十龙**: 精确的龙脉方位
- **天心十字**: 传统风水定位十字线

#### 2. 现代技术集成
- **设备传感器**: 自动获取设备方向数据
- **高精度计算**: ±0.5°精度的方位计算
- **实时更新**: 毫秒级的方向变化响应
- **性能监控**: 实时FPS和内存使用监控

#### 3. AI智能分析
- **方位评分**: 基于风水理论的智能评分
- **改善建议**: 个性化的风水调整建议
- **置信度评估**: AI分析结果的可信度指标

### 配置选项

#### 1. 主题样式
- **经典主题**: 传统中式风格，金色配色
- **现代主题**: 简约现代风格，蓝色配色
- **传统主题**: 古典风格，深色配色

#### 2. 显示选项
- **天心十字**: 显示/隐藏传统定位十字线
- **刻度显示**: 显示/隐藏度数刻度
- **罗盘大小**: 300px - 600px 可调节

#### 3. 功能开关
- **传感器**: 启用/禁用设备方向传感器
- **AI分析**: 启用/禁用智能分析功能

### 状态监控

#### 1. 实时数据
- **当前方向**: 显示精确到0.1°的方向角度
- **事件数量**: 记录的罗盘事件总数
- **AI分析状态**: 分析完成状态
- **传感器状态**: 校准状态和工作状态

#### 2. 事件日志
- **事件类型**: 方向变化、校准开始/完成、错误等
- **时间戳**: 精确的事件发生时间
- **事件数据**: 详细的事件参数信息

## 高级功能

### 1. 数据导出
点击"导出"按钮可以导出当前罗盘数据：
```json
{
  "currentDirection": 180.5,
  "compassEvents": [...],
  "aiAnalysis": {...},
  "timestamp": "2024-01-01T12:00:00.000Z"
}
```

### 2. 数据分享
- **原生分享**: 支持系统原生分享API
- **剪贴板复制**: 自动复制测量结果到剪贴板
- **社交分享**: 支持微信、微博等平台分享

### 3. 错误处理
- **错误边界**: 自动捕获和处理组件错误
- **优雅降级**: 传感器不可用时的备用方案
- **错误报告**: 详细的错误信息和恢复建议

## 技术规格

### 1. 性能指标
- **渲染性能**: 60 FPS 流畅动画
- **响应时间**: < 16ms 的交互响应
- **内存使用**: < 50MB 内存占用
- **精度要求**: ±0.5° 方向精度

### 2. 兼容性
- **浏览器**: Chrome 90+, Firefox 88+, Safari 14+
- **设备**: 支持陀螺仪的移动设备
- **系统**: iOS 13+, Android 8+
- **框架**: React 19.1.0, Next.js 15

### 3. 依赖项
```json
{
  "konva": "^9.2.0",
  "react-konva": "^18.2.10",
  "@radix-ui/react-tabs": "^1.0.4",
  "class-variance-authority": "^0.7.0"
}
```

## 开发集成

### 1. 组件引入
```typescript
import { FengShuiCompass } from '@/components/compass/feng-shui-compass';
import { CompassErrorBoundary } from '@/components/compass';
```

### 2. 基本使用
```typescript
<CompassErrorBoundary>
  <FengShuiCompass
    width={500}
    height={500}
    theme="classic"
    showTianxinCross={true}
    showScale={true}
    enableSensor={true}
    enableAI={true}
    onDirectionChange={(direction) => console.log(direction)}
    onEvent={(event) => console.log(event)}
    onAnalysisResult={(result) => console.log(result)}
  />
</CompassErrorBoundary>
```

### 3. 事件处理
```typescript
const handleCompassEvent = (event: CompassEvent) => {
  switch (event.type) {
    case 'direction_change':
      // 处理方向变化
      break;
    case 'calibration_complete':
      // 处理校准完成
      break;
    case 'analysis_complete':
      // 处理AI分析完成
      break;
  }
};
```

## 故障排除

### 1. 常见问题

#### 传感器不工作
- **检查权限**: 确保浏览器已授予设备方向权限
- **HTTPS要求**: 传感器API需要HTTPS环境
- **设备支持**: 确认设备具有陀螺仪传感器

#### 罗盘显示异常
- **清除缓存**: 刷新页面或清除浏览器缓存
- **检查控制台**: 查看浏览器控制台错误信息
- **重置配置**: 点击"重置"按钮恢复默认设置

#### 性能问题
- **降低分辨率**: 减小罗盘尺寸提升性能
- **关闭特效**: 禁用不必要的视觉效果
- **更新浏览器**: 使用最新版本浏览器

### 2. 调试模式
开启浏览器开发者工具查看详细日志：
```javascript
// 在控制台中启用调试模式
window.compassDebug = true;
```

### 3. 性能监控
查看性能监控面板了解系统状态：
- **FPS计数器**: 实时帧率显示
- **内存使用**: 内存占用情况
- **渲染时间**: 每帧渲染耗时

## 最佳实践

### 1. 使用建议
- **稳定环境**: 在稳定的环境中使用以获得最佳精度
- **校准操作**: 定期进行传感器校准
- **数据备份**: 重要测量结果及时导出保存

### 2. 性能优化
- **合理尺寸**: 根据设备性能选择合适的罗盘尺寸
- **按需启用**: 仅在需要时启用AI分析功能
- **及时清理**: 定期清理事件日志避免内存积累

### 3. 安全考虑
- **权限管理**: 谨慎授予设备传感器权限
- **数据隐私**: 导出的数据可能包含位置信息
- **网络安全**: 确保在安全的网络环境中使用

## 更新日志

### v1.0.0 (2024-01-01)
- ✅ 完整的风水罗盘功能
- ✅ 传感器数据集成
- ✅ AI分析系统
- ✅ 多主题支持
- ✅ 性能监控
- ✅ 错误边界保护

### 计划功能
- 🔄 WebGL渲染支持
- 🔄 离线模式
- 🔄 云端同步
- 🔄 语音交互
- 🔄 AR增强现实

## 技术支持

如遇到问题或需要技术支持，请：
1. 查看本使用指南
2. 检查浏览器控制台错误
3. 尝试重置罗盘配置
4. 联系开发团队获取帮助

---

*风水罗盘组件 - 传统智慧与现代技术的完美结合*