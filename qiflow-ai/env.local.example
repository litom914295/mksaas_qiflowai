# ===========================================
# AI八字风水大师 - 环境变量配置示例
# ===========================================

# ===========================================
# AI 服务提供商配置 (必需：至少配置一个)
# ===========================================

# OpenAI (推荐 - 支持精简和完整模型)
# 支持的模型：
# - 精简层：gpt-4o-mini (低成本，快速响应)
# - 完整层：gpt-4o (高质量，复杂分析)
# - 其他：gpt-4-turbo, gpt-3.5-turbo
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_BASE_URL=https://api.openai.com/v1

# Anthropic Claude (推荐 - 教育风格首选)
# 支持的模型：
# - 精简层：claude-3-haiku-20240307 (快速响应)
# - 完整层：claude-3-5-sonnet-20241022 (高质量分析)
# - 其他：claude-3-5-haiku-20241022, claude-3-sonnet-20240229
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here
ANTHROPIC_BASE_URL=https://api.anthropic.com/v1

# Google Gemini (推荐 - 多语言支持)
# 支持的模型：
# - 精简层：gemini-1.5-flash (快速响应)
# - 完整层：gemini-1.5-pro (高质量分析)
# - 其他：gemini-1.0-pro
GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_BASE_URL=https://generativelanguage.googleapis.com/v1beta

# DeepSeek (推荐 - 中文优化)
# 支持的模型：
# - 精简层：deepseek-chat (中文优化，成本低)
# - 完整层：deepseek-chat (中文理解能力强)
# - 其他：deepseek-reasoner
DEEPSEEK_API_KEY=sk-your-deepseek-key-here
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1

# ===========================================
# Supabase 配置 (必需)
# ===========================================
# 获取方式：
# 1. 访问 https://supabase.com
# 2. 创建新项目
# 3. 进入 Settings > API
# 4. 复制 Project URL 和 API Keys

# 项目URL (从Supabase仪表板复制)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co

# 匿名密钥 (公开，用于客户端)
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# 服务角色密钥 (私有，仅服务端使用)
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ===========================================
# 数据库配置 (必需)
# ===========================================
# 获取方式：
# 1. 在Supabase仪表板的 Settings > API 页面
# 2. 找到 "Database" 部分
# 3. 复制 "Connection string" 中的URI
# 4. 替换 [YOUR-PASSWORD] 为您的数据库密码

# 数据库连接字符串
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-ID].supabase.co:5432/postgres

# ===========================================
# 应用配置 (必需)
# ===========================================
# 生成方式：
# 方法1: openssl rand -base64 32
# 方法2: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# 方法3: 访问 https://generate-secret.vercel.app/32

# 认证密钥 (32位随机字符串)
NEXTAUTH_SECRET=your-random-secret-key-here-minimum-32-characters

# 应用URL
NEXTAUTH_URL=http://localhost:3000

# 游客会话密钥 (32位随机字符串)
GUEST_SESSION_SECRET=your-guest-session-secret-key-here-minimum-32-characters

# ===========================================
# 地图服务配置 (可选)
# ===========================================
# 高德地图（中国大陆）
AMAP_API_KEY=your-amap-api-key
AMAP_WEB_API_KEY=your-amap-web-api-key

# Google Maps（国际）
# GOOGLE_MAPS_API_KEY=your-google-maps-api-key

# 百度地图（中国大陆）
# BAIDU_MAP_API_KEY=your-baidu-map-api-key

# ===========================================
# 功能开关 (可选)
# ===========================================
ENABLE_AI_FEATURES=true
ENABLE_GUEST_MODE=true
ENABLE_DEBUG_MODE=false

# ===========================================
# AI模型配置 (可选 - 自定义模型选择)
# ===========================================
# 精简层模型列表 (用逗号分隔)
AI_LIGHTWEIGHT_MODELS=gpt-4o-mini,claude-3-haiku-20240307,gemini-1.5-flash,deepseek-chat

# 完整层模型列表 (用逗号分隔)
AI_FULL_MODELS=gpt-4o,claude-3-5-sonnet-20241022,gemini-1.5-pro

# 提供商优先级 (用逗号分隔，按优先级排序)
AI_PROVIDER_PRIORITY=deepseek,openai,anthropic,gemini

# 成本控制
AI_MAX_COST_PER_REQUEST=0.1
AI_ENABLE_COST_OPTIMIZATION=true

# ===========================================
# 速率限制配置 (可选)
# ===========================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# ===========================================
# 自定义AI提供商URL (可选)
# ===========================================
# 如果您使用兼容的API提供商
# OPENAI_BASE_URL=https://your-custom-openai-compatible-api.com/v1
# ANTHROPIC_BASE_URL=https://your-custom-anthropic-compatible-api.com/v1

# ===========================================
# 支付配置 (可选 - 如果需要付费功能)
# ===========================================
# NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
# STRIPE_SECRET_KEY=sk_test_...
# STRIPE_WEBHOOK_SECRET=whsec_...

# ===========================================
# 应用URL配置 (可选)
# ===========================================
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ===========================================
# 开发环境快速配置说明
# ===========================================
# 1. 复制此文件为 .env.local
# 2. 至少配置一个AI服务提供商的API密钥
# 3. 配置Supabase相关密钥
# 4. 生成随机的NEXTAUTH_SECRET和GUEST_SESSION_SECRET
# 5. 运行 npm run dev 启动开发服务器

# ===========================================
# AI模型使用策略详解
# ===========================================
# 系统使用四层处理策略，按优先级顺序：
#
# 1. 缓存层 (Cache)
#    - 检查内存缓存，避免重复请求
#    - 缓存时间：5分钟
#
# 2. 模板层 (Template)
#    - 使用预定义模板生成响应
#    - 适用于标准化的风水分析
#
# 3. 精简层 (Lightweight)
#    - 低成本模型，快速响应
#    - 适用场景：简单查询、快速回复
#    - 模型列表：
#      * gpt-4o-mini (OpenAI) - $0.00015/$0.0006 per 1K tokens
#      * claude-3-haiku-20240307 (Anthropic) - $0.00025/$0.00125 per 1K tokens
#      * gemini-1.5-flash (Google) - $0.000075/$0.0003 per 1K tokens
#      * deepseek-chat (DeepSeek) - $0.00014/$0.00028 per 1K tokens
#
# 4. 完整层 (Full)
#    - 高质量模型，复杂分析
#    - 适用场景：深度分析、教育性回复
#    - 模型列表：
#      * gpt-4o (OpenAI) - $0.005/$0.015 per 1K tokens
#      * claude-3-5-sonnet-20241022 (Anthropic) - $0.003/$0.015 per 1K tokens
#      * gemini-1.5-pro (Google) - $0.00125/$0.005 per 1K tokens
#
# 智能路由规则：
# - 教育风格用户 → Claude-3.5-Sonnet (详细解释)
# - 风水主题 → DeepSeek (中文优化)
# - 西方用户 → GPT-4o-mini (英文友好)
# - 复杂分析 → 完整层模型
# - 简单查询 → 精简层模型
#
# 故障转移：
# - 如果主模型失败，自动尝试备用模型
# - 如果所有AI模型都失败，使用模板响应
# - 如果模板也失败，返回友好的错误提示
