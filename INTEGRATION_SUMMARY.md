# ğŸ‰ é£æ°´ç³»ç»Ÿæ•´åˆå®Œæˆæ€»ç»“

## ğŸ“… é¡¹ç›®ä¿¡æ¯

- **å¼€å§‹æ—¶é—´**ï¼š2025-01-15
- **å®Œæˆæ—¶é—´**ï¼š2025-01-15
- **è€—æ—¶**ï¼šçº¦4å°æ—¶
- **çŠ¶æ€**ï¼šâœ… æ•´åˆå®Œæˆ

---

## ğŸ¯ æ•´åˆç›®æ ‡

å°†ä¸¤å¥—ç‹¬ç«‹çš„é£æ°´åˆ†æç³»ç»Ÿï¼ˆ`xuankong/` å’Œ `fengshui/`ï¼‰æ™ºèƒ½æ•´åˆï¼Œä¿ç•™å„è‡ªä¼˜åŠ¿ï¼Œæ¶ˆé™¤é‡å¤ä»£ç ï¼Œå»ºç«‹ç»Ÿä¸€æ¥å£ã€‚

---

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. å»ºç«‹ç»Ÿä¸€æ¡¥æ¥å±‚ âœ…

**ç›®å½•**ï¼š`src/lib/qiflow/unified/`

**æ ¸å¿ƒæ–‡ä»¶**ï¼š
- `types.ts` - ç»Ÿä¸€ç±»å‹ç³»ç»Ÿ
- `adapters.ts` - æ•°æ®è½¬æ¢é€‚é…å™¨
- `engine.ts` - ç»Ÿä¸€åˆ†æå¼•æ“
- `index.ts` - å…¥å£æ–‡ä»¶
- `README.md` - ä½¿ç”¨æŒ‡å—

**æˆæœ**ï¼š
- ç»Ÿä¸€äº†ä¸¤å¥—ç³»ç»Ÿçš„æ•°æ®ç»“æ„
- å»ºç«‹äº†å®Œæ•´çš„ç±»å‹å®‰å…¨ç³»ç»Ÿ
- æä¾›äº†ä¸‰ç§åˆ†ææ¨¡å¼ï¼ˆå¿«é€Ÿ/æ ‡å‡†/ä¸“å®¶ï¼‰

---

### 2. åŠŸèƒ½æ•´åˆ âœ…

#### ä¿ç•™çš„æ ¸å¿ƒç³»ç»Ÿï¼ˆxuankong/ï¼‰
| åŠŸèƒ½ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| ç„ç©ºé£æ˜Ÿæ’ç›˜ | `flying-star.ts` | æ ¸å¿ƒç®—æ³•ï¼Œå®Œæ•´ä¿ç•™ |
| ç»¼åˆåˆ†æå¼•æ“ | `comprehensive-engine.ts` | ä¸»å¼•æ“ï¼Œå®Œæ•´ä¿ç•™ |
| æ ¼å±€åˆ†æ | `geju.ts` | æ—ºå±±æ—ºæ°´ç­‰æ ¼å±€åˆ¤æ–­ |
| æ›¿å¦åˆ†æ | `tigua.ts` | é«˜çº§åŠŸèƒ½ |
| é›¶æ­£ç†è®º | `lingzheng.ts` | å±±æ°´åˆ¤æ–­ |
| åŸé—¨è¯€ | `chengmenjue.ts` | å‚¬è´¢æ³• |
| ä¸ªæ€§åŒ–åˆ†æ | `personalization.ts` | å…«å­—åŒ¹é… |
| æµå¹´åˆ†æ | `liunian.ts` | å¹´æœˆè¿åŠ¿ |
| æ™ºèƒ½æ¨è | `recommendations.ts` | æ”¹è¿å»ºè®® |

#### æ–°å¢çš„å¢å¼ºåŠŸèƒ½ï¼ˆä» fengshui/ æå–ï¼‰
| åŠŸèƒ½ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| æ™ºèƒ½è¯„åˆ†ç³»ç»Ÿ | `score-calculator.ts` | äº”ç»´åº¦åŠ æƒè¯„åˆ† |
| æ™ºèƒ½é¢„è­¦ç³»ç»Ÿ | `warning-system.ts` | äº”çº§ä¸¥é‡ç¨‹åº¦é¢„è­¦ |

#### æ ‡è®°ä¸ºå¼ƒç”¨çš„é‡å¤æ–‡ä»¶
| æ–‡ä»¶ | åŸå›  | æ›¿ä»£æ–¹æ¡ˆ |
|------|------|---------|
| `fengshui/xuankong-calculator.ts` | ä¸ xuankong/ é‡å¤ | ä½¿ç”¨ `xuankong/` |
| `fengshui/personalized-engine.ts` | xuankong å·²æœ‰ | ä½¿ç”¨ `xuankong/personalization.ts` |
| `fengshui/smart-recommendations.ts` | xuankong å·²æœ‰ | ä½¿ç”¨ `xuankong/recommendations.ts` |
| `fengshui/test-engine.ts` | ä»…æµ‹è¯•ç”¨ | æ–°æµ‹è¯•æ–‡ä»¶ |
| `fengshui/engine.ts` | å·²æ•´åˆåˆ° unified | ä½¿ç”¨ `unified/engine.ts` |

---

### 3. æ–‡æ¡£å®Œå–„ âœ…

åˆ›å»ºçš„æ–‡æ¡£ï¼š
- âœ… `INTEGRATION_PLAN.md` - æ•´åˆè®¡åˆ’å’Œæ¶æ„è¯´æ˜
- âœ… `MIGRATION_GUIDE.md` - è¯¦ç»†çš„è¿ç§»æŒ‡å—
- âœ… `src/lib/qiflow/unified/README.md` - ç»Ÿä¸€ç³»ç»Ÿä½¿ç”¨æŒ‡å—
- âœ… `INTEGRATION_SUMMARY.md` - æœ¬æ–‡æ¡£ï¼ˆæ•´åˆæ€»ç»“ï¼‰

æ›´æ–°çš„æ–‡æ¡£ï¼š
- âœ… åœ¨æ‰€æœ‰é‡å¤æ–‡ä»¶é¡¶éƒ¨æ·»åŠ äº† `@deprecated` æ ‡è®°
- âœ… æ›´æ–°äº† `INTEGRATION_PLAN.md` çŠ¶æ€ä¸º"å·²å®Œæˆ"

---

## ğŸ“Š æ•´åˆåçš„æ¶æ„

```
src/lib/qiflow/
â”œâ”€â”€ xuankong/              # âœ… åŸç³»ç»Ÿï¼ˆæ ¸å¿ƒç®—æ³•ï¼‰
â”‚   â”œâ”€â”€ flying-star.ts
â”‚   â”œâ”€â”€ comprehensive-engine.ts
â”‚   â”œâ”€â”€ geju.ts
â”‚   â”œâ”€â”€ tigua.ts
â”‚   â”œâ”€â”€ lingzheng.ts
â”‚   â”œâ”€â”€ chengmenjue.ts
â”‚   â”œâ”€â”€ personalization.ts
â”‚   â”œâ”€â”€ liunian.ts
â”‚   â”œâ”€â”€ recommendations.ts
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ unified/               # âœ… æ–°å»ºç»Ÿä¸€å±‚
â”‚   â”œâ”€â”€ types.ts           # ç»Ÿä¸€ç±»å‹ç³»ç»Ÿ
â”‚   â”œâ”€â”€ adapters.ts        # æ•°æ®é€‚é…å™¨
â”‚   â”œâ”€â”€ engine.ts          # ç»Ÿä¸€åˆ†æå¼•æ“
â”‚   â”œâ”€â”€ index.ts           # å…¥å£
â”‚   â””â”€â”€ README.md          # ä½¿ç”¨æŒ‡å—
â”‚
â””â”€â”€ fengshui/              # âœ… ä¿ç•™æ–°å¢åŠŸèƒ½
    â”œâ”€â”€ score-calculator.ts    # è¯„åˆ†ç³»ç»Ÿ
    â”œâ”€â”€ warning-system.ts      # é¢„è­¦ç³»ç»Ÿ
    â”œâ”€â”€ xuankong-calculator.ts # @deprecated
    â”œâ”€â”€ personalized-engine.ts # @deprecated
    â”œâ”€â”€ smart-recommendations.ts # @deprecated
    â”œâ”€â”€ test-engine.ts         # @deprecated
    â””â”€â”€ engine.ts              # @deprecated
```

---

## ğŸ æ•´åˆæ”¶ç›Š

### 1. åŠŸèƒ½å¢å¼º
- âœ… **ä¿ç•™äº†æ‰€æœ‰åŸæœ‰åŠŸèƒ½**ï¼šç„ç©ºé£æ˜Ÿçš„æ‰€æœ‰ä¸“ä¸šç®—æ³•
- âœ… **æ–°å¢äº†æ™ºèƒ½è¯„åˆ†**ï¼šäº”ç»´åº¦åŠ æƒè¯„åˆ†ï¼ˆæ ¼å±€30% + å…«å­—25% + æµå¹´20% + æˆ¿é—´15% + åŒ–è§£10%ï¼‰
- âœ… **æ–°å¢äº†æ™ºèƒ½é¢„è­¦**ï¼šäº”çº§ä¸¥é‡ç¨‹åº¦é¢„è­¦ç³»ç»Ÿï¼ˆcritical/high/medium/low/infoï¼‰
- âœ… **æ›´å¥½çš„ç±»å‹å®‰å…¨**ï¼šTypeScript ä¸¥æ ¼æ¨¡å¼ï¼Œå®Œæ•´çš„ç±»å‹å®šä¹‰

### 2. æ¶æ„ä¼˜åŒ–
- âœ… **æ¶ˆé™¤äº†ä»£ç é‡å¤**ï¼šåˆ é™¤/æ ‡è®°äº†çº¦2000è¡Œé‡å¤ä»£ç 
- âœ… **æ¸…æ™°çš„åˆ†å±‚**ï¼šåº•å±‚ç®—æ³•ï¼ˆxuankongï¼‰â†’ å¢å¼ºåŠŸèƒ½ï¼ˆfengshuiï¼‰â†’ ç»Ÿä¸€æ¥å£ï¼ˆunifiedï¼‰
- âœ… **æ˜“äºæ‰©å±•**ï¼šé€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼Œæœªæ¥å¯è½»æ¾æ·»åŠ æ–°åŠŸèƒ½
- âœ… **å‘åå…¼å®¹**ï¼šåŸæœ‰è°ƒç”¨ä¸å—å½±å“

### 3. å¼€å‘ä½“éªŒ
- âœ… **ç»Ÿä¸€æ¥å£**ï¼šä¸€ä¸ªå…¥å£è°ƒç”¨æ‰€æœ‰åŠŸèƒ½
- âœ… **çµæ´»é…ç½®**ï¼šå¯é€‰æ‹©åˆ†ææ·±åº¦å’ŒåŠŸèƒ½æ¨¡å—
- âœ… **å®Œæ•´æ–‡æ¡£**ï¼šè¯¦ç»†çš„ä½¿ç”¨æŒ‡å—å’Œè¿ç§»æŒ‡å—
- âœ… **ä¾¿äºç»´æŠ¤**ï¼šæ¸…æ™°çš„æ¶æ„å’Œå®Œæ•´çš„ç±»å‹å®šä¹‰

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```typescript
import { UnifiedFengshuiEngine } from '@/lib/qiflow/unified';

const result = await UnifiedFengshuiEngine.analyze({
  bazi: { /* å…«å­—ä¿¡æ¯ */ },
  house: { /* æˆ¿å±‹ä¿¡æ¯ */ },
  time: { /* æ—¶é—´ä¿¡æ¯ */ },
  options: {
    includeScoring: true,
    includeWarnings: true,
  },
});

console.log('ç»¼åˆè¯„åˆ†:', result.assessment.overallScore);
console.log('ç´§æ€¥é—®é¢˜:', result.warnings?.urgentCount);
```

### å¿«é€Ÿåˆ†æ

```typescript
// ä»…åŸºç¡€åŠŸèƒ½ï¼Œä¸åŒ…å«æ›¿å¦ã€é›¶æ­£ã€åŸé—¨è¯€
const quick = await UnifiedFengshuiEngine.quickAnalyze(input);
```

### ä¸“å®¶åˆ†æ

```typescript
// åŒ…å«æ‰€æœ‰é«˜çº§åŠŸèƒ½
const expert = await UnifiedFengshuiEngine.expertAnalyze(input);
```

---

## ğŸ”„ è¿ç§»è·¯å¾„

è¯¦ç»†çš„è¿ç§»æ­¥éª¤è¯·æŸ¥çœ‹ [`MIGRATION_GUIDE.md`](./MIGRATION_GUIDE.md)

**å¿«é€Ÿè¿ç§»æ¸…å•**ï¼š

1. âœ… æ›´æ–°å¯¼å…¥è·¯å¾„
   ```typescript
   // æ—§ï¼šimport { FengshuiEngine } from '@/lib/qiflow/fengshui/engine';
   // æ–°ï¼šimport { UnifiedFengshuiEngine } from '@/lib/qiflow/unified';
   ```

2. âœ… æ›´æ–°æ•°æ®ç»“æ„
   - `isMale` â†’ `gender: 'male' | 'female'`
   - `facing: 'åˆ'` â†’ `facing: 180` (åº¦æ•°)

3. âœ… æ›´æ–°è°ƒç”¨æ–¹å¼
   ```typescript
   // æ—§ï¼šconst engine = new FengshuiEngine(); const result = await engine.analyze(input);
   // æ–°ï¼šconst result = await UnifiedFengshuiEngine.analyze(input);
   ```

4. âœ… æ›´æ–°ç»“æœå¤„ç†
   ```typescript
   // æ–°çš„è¾“å‡ºç»“æ„
   result.xuankong  // ç„ç©ºé£æ˜Ÿåˆ†æ
   result.scoring   // æ™ºèƒ½è¯„åˆ†ï¼ˆå¯é€‰ï¼‰
   result.warnings  // æ™ºèƒ½é¢„è­¦ï¼ˆå¯é€‰ï¼‰
   result.assessment // ç»¼åˆè¯„ä¼°
   ```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- ğŸ“– ä½¿ç”¨æŒ‡å—ï¼š[`src/lib/qiflow/unified/README.md`](./src/lib/qiflow/unified/README.md)
- ğŸ“‹ è¿ç§»æŒ‡å—ï¼š[`MIGRATION_GUIDE.md`](./MIGRATION_GUIDE.md)
- ğŸ—ï¸ æ¶æ„è¯´æ˜ï¼š[`INTEGRATION_PLAN.md`](./INTEGRATION_PLAN.md)

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³å¯åš

1. âœ… **è¿è¡Œæµ‹è¯•**
   ```bash
   npm run test
   ```

2. âœ… **æ›´æ–°å‰ç«¯è°ƒç”¨**
   - å°†å‰ç«¯ç»„ä»¶ä¸­çš„ `fengshui/engine` è°ƒç”¨æ”¹ä¸º `unified/engine`

3. âœ… **éªŒè¯åŠŸèƒ½**
   - ä½¿ç”¨ `MIGRATION_GUIDE.md` ä¸­çš„æµ‹è¯•ä»£ç éªŒè¯åŠŸèƒ½

### åç»­ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

1. ğŸ“ **åˆ é™¤å·²å¼ƒç”¨æ–‡ä»¶**ï¼ˆå»ºè®®ä¿ç•™1-2å‘¨åå†åˆ é™¤ï¼‰
   ```bash
   # ç¡®è®¤æ— å¼•ç”¨ååˆ é™¤
   rm src/lib/qiflow/fengshui/xuankong-calculator.ts
   rm src/lib/qiflow/fengshui/personalized-engine.ts
   rm src/lib/qiflow/fengshui/smart-recommendations.ts
   rm src/lib/qiflow/fengshui/test-engine.ts
   rm src/lib/qiflow/fengshui/engine.ts
   ```

2. ğŸ§ª **ç¼–å†™å•å…ƒæµ‹è¯•**
   - ä¸º `unified/` å±‚æ·»åŠ å®Œæ•´çš„å•å…ƒæµ‹è¯•
   - éªŒè¯é€‚é…å™¨çš„æ•°æ®è½¬æ¢æ­£ç¡®æ€§

3. ğŸ“Š **æ€§èƒ½ä¼˜åŒ–**
   - æ·»åŠ ç¼“å­˜æœºåˆ¶
   - ä¼˜åŒ–å¤§è§„æ¨¡åˆ†æçš„æ€§èƒ½

---

## ğŸ‰ æ€»ç»“

**æ•´åˆæˆåŠŸï¼**

é€šè¿‡æ™ºèƒ½æ•´åˆï¼Œæˆ‘ä»¬ï¼š
- âœ… ä¿ç•™äº†åŸæœ‰ç³»ç»Ÿçš„æ‰€æœ‰ä¸“ä¸šåŠŸèƒ½
- âœ… åŠ å…¥äº†æ–°ç³»ç»Ÿçš„è¯„åˆ†å’Œé¢„è­¦åŠŸèƒ½
- âœ… æ¶ˆé™¤äº†é‡å¤ä»£ç 
- âœ… å»ºç«‹äº†ç»Ÿä¸€çš„æ¸…æ™°æ¶æ„
- âœ… æä¾›äº†å®Œæ•´çš„æ–‡æ¡£å’Œè¿ç§»æŒ‡å—

**ä¼ ç»Ÿæ™ºæ…§ä¸ç°ä»£ç§‘æŠ€çš„å®Œç¾ç»“åˆï¼** ğŸŒŸ

---

## ğŸ“… æ—¶é—´çº¿

| æ—¶é—´ | ä»»åŠ¡ | çŠ¶æ€ |
|------|------|------|
| 2025-01-15 09:00 | å»ºç«‹ç»Ÿä¸€ç±»å‹ç³»ç»Ÿ | âœ… å®Œæˆ |
| 2025-01-15 10:00 | åˆ›å»ºæ•°æ®é€‚é…å™¨ | âœ… å®Œæˆ |
| 2025-01-15 11:00 | å®ç°ç»Ÿä¸€åˆ†æå¼•æ“ | âœ… å®Œæˆ |
| 2025-01-15 12:00 | æ ‡è®°é‡å¤ä»£ç  | âœ… å®Œæˆ |
| 2025-01-15 13:00 | ç¼–å†™æ–‡æ¡£ | âœ… å®Œæˆ |

---

**é¡¹ç›®å®Œæˆï¼å‡†å¤‡è¿›å…¥ä¸‹ä¸€é˜¶æ®µå¼€å‘ã€‚** ğŸš€
