# 专业版八字分析使用说明

## 🎯 功能概述

已成功将 qiflow-ai 的专业八字分析系统迁移并整合到当前项目，提供完整的命理分析功能。

## ✨ 核心特性

### 1. 完整的四柱八字
- 年柱、月柱、日柱、时柱完整展示
- 天干地支详细解析
- 纳音五行说明

### 2. 五行力量分析
- 五行分布可视化（雷达图 + 柱状图）
- 日主强度计算
- 最强/最弱五行识别
- 五行平衡度分析

### 3. 格局与用神
- 命格类型判定（正格、从格、化格等）
- 格局纯度评分
- 辅助格局识别
- 用神、喜神、忌神详解
- 个性化调理建议

### 4. 神煞分析
- 吉神详解（天乙贵人、文昌星等）
- 凶神说明（羊刃、劫煞等）
- 神煞力量评估
- 化解建议

### 5. **⭐ 大运流年分析（专业版核心功能）**
- 一生大运周期时间线
- 每个大运的详细信息：
  - 干支组合
  - 起止年份与年龄
  - 五行属性
  - 运势质量（优秀/良好/中等/困难）
  - 详细描述
- 当前大运高亮显示
- 可视化时间轴展示

### 6. 详细解读
- **总览**：整体命局分析
- **性格**：性格特征与优势挑战
- **事业**：发展方向与适合行业
- **财运**：财运分析与理财建议
- **感情**：感情运势与关系分析
- **健康**：保健建议与注意事项

## 📖 使用方法

### 方式一：访客分析页面

1. 访问：`http://localhost:3000/zh-CN/guest-analysis`

2. 填写基本信息：
   - 姓名
   - 出生日期（阳历）
   - 出生时间（精确到分钟）
   - 性别

3. 提交后**自动显示专业版分析结果**

4. 可以在"标准版"和"专业版"之间切换：
   - **标准版**：基础四柱、五行分析
   - **专业版**：包含大运流年等完整功能

### 方式二：报告页面

1. 从统一表单提交后跳转到报告页面

2. 查看完整的八字命理分析

3. 支持 AI 聊天互动

## 🔍 查看大运分析

在**专业版**中，向下滚动到"大运流年"部分：

### 显示内容：
```
大运周期时间线
├── 10-19岁：甲子大运 | 木气当令 | 良好
├── 20-29岁：乙丑大运 | 火气当令 | 中等
├── 30-39岁：丙寅大运 | 土气当令 | 优秀 ⭐（当前）
├── 40-49岁：丁卯大运 | 金气当令 | 困难
└── ...
```

### 时间线特点：
- 可视化卡片展示
- 颜色编码区分运势质量：
  - 🟢 绿色 = 优秀
  - 🔵 蓝色 = 良好
  - ⚪ 灰色 = 中等
  - 🔴 红色 = 困难
- 当前大运特殊标记
- 点击可展开查看详细信息

## 🎨 UI 特色

### 专业版提示卡片
```
┌─────────────────────────────────────────┐
│ ⭐ 专业版八字分析                          │
│                                           │
│ 包含完整的四柱八字、五行分析、格局用神、    │
│ 神煞详解、大运流年预测等专业功能           │
│                                           │
│ ✨纳音解析  🌟十神分析                     │
│ 📅大运时间线 🔮流年预测                     │
└─────────────────────────────────────────┘
```

### 视图切换按钮
- 标准版 ｜ ⭐ 专业版（带动画效果）
- 默认显示专业版
- 一键切换，保留数据

## 🔧 技术实现

### 核心组件
1. **BaziApiResult** (`src/components/qiflow/analysis/bazi-api-result.tsx`)
   - 主要分析结果展示组件
   - 支持标准版/专业版切换
   - 默认显示专业版

2. **BaziProfessionalResult** (`src/components/qiflow/analysis/bazi-professional-result.tsx`)
   - 专业版详细展示
   - 包含大运流年时间线
   - 多维度详细解读

3. **LuckCycleTimeline** (`src/components/qiflow/charts/LuckCycleTimeline.tsx`)
   - 大运时间线可视化组件
   - 可交互的周期展示

### 数据适配器

#### 基础版
- `src/lib/adapters/bazi-professional-adapter.ts`
- 使用改进的模拟算法生成大运数据

#### 增强版（新增）
- `src/lib/adapters/bazi-enhanced-adapter.ts`
- **支持真实的大运计算算法**
- 集成 `luck-pillars.ts` 模块
- 可自动回退到改进算法

### 核心库
- `src/lib/bazi/luck-pillars.ts` - 大运分析器（已从 qiflow-ai 复制）
- `src/lib/bazi/ten-gods.ts` - 十神计算
- `src/lib/bazi/enhanced-calculator.ts` - 增强八字计算器

## 📊 数据流程

```
用户输入（姓名、生辰）
    ↓
提交表单
    ↓
调用 /api/qiflow/bazi-unified
    ↓
API 返回八字分析数据
    ↓
BaziApiResult 组件接收数据
    ↓
adaptToProfessionalBaziData 适配器转换
    ↓
BaziProfessionalResult 渲染（包含大运）
    ↓
LuckCycleTimeline 展示大运时间线
```

## 🆚 版本对比

| 功能 | 标准版 | 专业版 |
|------|--------|--------|
| 四柱八字 | ✅ | ✅ |
| 五行分析 | ✅ | ✅ |
| 可视化图表 | ✅ | ✅ |
| 纳音五行 | ❌ | ✅ |
| 格局用神 | 简要 | 详细 |
| 神煞分析 | ❌ | ✅ |
| **大运时间线** | ❌ | ✅ |
| **流年预测** | ❌ | ✅ |
| 详细解读 | ❌ | ✅ |
| 多维度分析 | ❌ | ✅ |

## 🎁 免费试用

- 访客无需登录即可使用
- 完整的专业版功能
- 仅提示登录可保存历史记录
- AI 智能对话需要登录

## 📝 使用示例

### 示例输入
```
姓名：张三
出生日期：1990-05-15
出生时间：14:30
性别：男
```

### 示例输出（专业版片段）
```
八字命盘
┌─────┬─────┬─────┬─────┐
│ 庚午 │ 辛巳 │ 戊辰 │ 己未 │
│年柱 │月柱 │日柱 │时柱 │
└─────┴─────┴─────┴─────┘

五行力量
木: ████░ 20%
火: ███████░ 35%
土: █████░ 25%
金: ███░ 15%
水: ██░ 5%

日主强度: 62分（偏强）
最强五行：火
最弱五行：水

大运周期
⏱ 10-19岁：己卯大运（木气当令）- 良好
⏱ 20-29岁：戊寅大运（木气当令）- 中等
⏱ 30-39岁：丁丑大运（土气当令）- 优秀 ⭐当前
⏱ 40-49岁：丙子大运（水气当令）- 困难
```

## 🚀 下一步优化

1. **集成真实大运计算**
   - 目前使用改进的模拟算法
   - 可升级为基于真实八字引擎的计算

2. **增强大运详情**
   - 添加每个大运的详细分析页面
   - 流年互动展示
   - 重大事件预测

3. **十神分析深化**
   - 详细的十神关系解读
   - 五大维度影响分析

4. **AI 智能解读**
   - 基于大运的个性化建议
   - 时机把握指导

## 📞 访问路由

- 访客分析：`/zh-CN/guest-analysis`
- 报告页面：`/zh-CN/report`
- API 端点：`/api/qiflow/bazi-unified`

---

**最后更新：** 2025-01-19

**状态：** ✅ 完成并可用

**默认模式：** 专业版（包含大运流年分析）
