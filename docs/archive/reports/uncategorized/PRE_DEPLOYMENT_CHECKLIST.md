# ğŸš€ QiFlow AI éƒ¨ç½²å‰æ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2025-10-18  
**é¡¹ç›®ç‰ˆæœ¬**: 0.1.0  
**Next.jsç‰ˆæœ¬**: 15.5.5

---

## ğŸ“‹ æ£€æŸ¥æ‘˜è¦

| ç±»åˆ« | çŠ¶æ€ | ä¸¥é‡ç¨‹åº¦ |
|------|------|---------|
| âœ… ç¯å¢ƒå˜é‡é…ç½® | é€šè¿‡ | - |
| âœ… å®‰å…¨é…ç½® | é€šè¿‡ | - |
| âš ï¸ ä¾èµ–åŒ… | éœ€è¦æ›´æ–° | ä½ |
| âœ… æ€§èƒ½ä¼˜åŒ– | é€šè¿‡ | - |
| âš ï¸ SEOé…ç½® | å·²ä¿®å¤ | ä¸­ |
| âš ï¸ ç›‘æ§é…ç½® | éœ€è¦é…ç½® | é«˜ |
| âœ… æ•°æ®åº“é…ç½® | é€šè¿‡ | - |
| âœ… APIå®‰å…¨ | é€šè¿‡ | - |

---

## âœ… é€šè¿‡çš„æ£€æŸ¥é¡¹

### 1. ç¯å¢ƒå˜é‡é…ç½®
- âœ… `.env.production.example` æ–‡ä»¶å®Œæ•´
- âœ… `.env.production` æ–‡ä»¶å·²å­˜åœ¨
- âœ… åŒ…å«æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡æ¨¡æ¿
- âœ… ç¯å¢ƒå˜é‡éªŒè¯æ¨¡å— (`src/lib/env.ts`) é…ç½®å®Œå–„

**å»ºè®®**: éƒ¨ç½²å‰ç¡®ä¿æ‰€æœ‰ç”Ÿäº§ç¯å¢ƒå˜é‡å·²æ­£ç¡®è®¾ç½®

### 2. å®‰å…¨é…ç½®
- âœ… å®‰å…¨å¤´éƒ¨å·²é…ç½® (X-Frame-Options, CSP, etc.)
- âœ… è®¤è¯ä¸­é—´ä»¶å·²å®ç°
- âœ… å—ä¿æŠ¤è·¯ç”±é…ç½®æ­£ç¡®
- âœ… APIè·¯ç”±ä½¿ç”¨Zodè¿›è¡Œè¾“å…¥éªŒè¯
- âœ… å¯†ç ä½¿ç”¨bcryptå“ˆå¸Œ
- âœ… æµ‹è¯•è·¯ç”±é™åˆ¶ä¸ºå¼€å‘ç¯å¢ƒ

**å®‰å…¨å¤´éƒ¨é…ç½®**:
```typescript
X-DNS-Prefetch-Control: on
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Referrer-Policy: origin-when-cross-origin
```

### 3. æ€§èƒ½ä¼˜åŒ–
- âœ… ç”Ÿäº§ç¯å¢ƒç¦ç”¨source maps
- âœ… å¯ç”¨gzipå‹ç¼©
- âœ… å›¾ç‰‡ä¼˜åŒ–é…ç½®å®Œå–„ (AVIF, WebP)
- âœ… ä»£ç åˆ†å‰²å’ŒåŠ¨æ€å¯¼å…¥å·²å®ç°
- âœ… åŒ…å¯¼å…¥ä¼˜åŒ–å·²é…ç½®
- âœ… ç”Ÿäº§ç¯å¢ƒç§»é™¤console.log

**ä¼˜åŒ–é…ç½®**:
- å›¾ç‰‡æ ¼å¼: AVIF, WebP
- æœ€å°ç¼“å­˜TTL: 60ç§’
- å‹ç¼©: å·²å¯ç”¨
- Consoleç§»é™¤: ä¿ç•™errorå’Œwarn

### 4. æ•°æ®åº“é…ç½®
- âœ… DATABASE_URL ç¯å¢ƒå˜é‡å·²é…ç½®
- âœ… è‡ªå®šä¹‰æ•°æ®åº“æ¥å£ç±»å‹å®Œå–„
- âœ… è¿æ¥æ± é…ç½®å»ºè®®å·²æä¾›

### 5. APIè·¯ç”±å®‰å…¨
- âœ… æ‰€æœ‰APIè·¯ç”±ä½¿ç”¨ZodéªŒè¯
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… æƒé™æ£€æŸ¥å·²å®ç°
- âœ… æ•æ„Ÿä¿¡æ¯å·²ä¿æŠ¤

---

## âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜

### 1. ä¾èµ–åŒ…æ›´æ–° (ä½ä¼˜å…ˆçº§)

**è¿‡æ—¶çš„ä¸»è¦åŒ…**:
- `@biomejs/biome`: 1.9.4 â†’ 2.2.6 (å»ºè®®è°¨æ…å‡çº§)
- `next`: 15.5.5 â†’ 15.5.6 (å°ç‰ˆæœ¬æ›´æ–°)
- `react`: 19.1.0 â†’ 19.2.0
- `stripe`: 17.7.0 â†’ 19.1.0 (ä¸»è¦ç‰ˆæœ¬æ›´æ–°ï¼Œéœ€è¦æµ‹è¯•)

**å»ºè®®**:
```bash
# æ›´æ–°æ¬¡è¦ç‰ˆæœ¬
npm update

# æµ‹è¯•åå†æ›´æ–°ä¸»è¦ç‰ˆæœ¬
npm install @biomejs/biome@latest --save-dev
npm install stripe@latest
```

### 2. SEOé…ç½® (å·²ä¿®å¤)

**å·²åˆ›å»ºçš„æ–‡ä»¶**:
- âœ… `public/robots.txt` - SEOçˆ¬è™«æ§åˆ¶
- âœ… `public/sitemap.xml` - ç½‘ç«™åœ°å›¾æ¨¡æ¿

**åç»­å·¥ä½œ**:
1. åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­å°† `yourdomain.com` æ›¿æ¢ä¸ºå®é™…åŸŸå
2. è€ƒè™‘ä½¿ç”¨ `next-sitemap` åŒ…è‡ªåŠ¨ç”Ÿæˆsitemap
3. æ·»åŠ åŠ¨æ€é¡µé¢åˆ°sitemap (åšå®¢ã€äº§å“ç­‰)

**å®‰è£…next-sitemap** (å¯é€‰):
```bash
npm install next-sitemap
```

### 3. ç›‘æ§é…ç½® (é«˜ä¼˜å…ˆçº§) âš ï¸

**Sentryé…ç½®ç¼ºå¤±**:
- âŒ `sentry.client.config.ts` æœªåˆ›å»º
- âŒ `sentry.server.config.ts` æœªåˆ›å»º
- âŒ Next.jsé…ç½®æœªé›†æˆSentry

**å·²åˆ›å»º**: `SENTRY_SETUP.md` è¯¦ç»†é…ç½®æŒ‡å—

**ç«‹å³è¡ŒåŠ¨**:
1. é˜…è¯» `SENTRY_SETUP.md`
2. åˆ›å»ºSentryé…ç½®æ–‡ä»¶
3. é…ç½®ç¯å¢ƒå˜é‡
4. æµ‹è¯•é”™è¯¯è¿½è¸ª

---

## ğŸ”§ éƒ¨ç½²å‰å¿…åšä»»åŠ¡

### é«˜ä¼˜å…ˆçº§ (å¿…é¡»å®Œæˆ)

1. **é…ç½®Sentryç›‘æ§**
   ```bash
   # 1. åˆ›å»ºé…ç½®æ–‡ä»¶ (å‚è€ƒ SENTRY_SETUP.md)
   # 2. è®¾ç½®ç¯å¢ƒå˜é‡
   # 3. æµ‹è¯•é”™è¯¯è¿½è¸ª
   ```

2. **æ›´æ–°åŸŸåé…ç½®**
   - [ ] `public/robots.txt` ä¸­çš„åŸŸå
   - [ ] `public/sitemap.xml` ä¸­çš„åŸŸå
   - [ ] `.env.production` ä¸­çš„ `NEXT_PUBLIC_APP_URL`
   - [ ] `.env.production` ä¸­çš„ `BETTER_AUTH_URL`

3. **éªŒè¯ç¯å¢ƒå˜é‡**
   - [ ] æ•°æ®åº“è¿æ¥URL
   - [ ] è®¤è¯å¯†é’¥ (BETTER_AUTH_SECRET >= 32å­—ç¬¦)
   - [ ] AIæœåŠ¡å¯†é’¥
   - [ ] æ”¯ä»˜æœåŠ¡å¯†é’¥ (å¦‚å¯ç”¨)
   - [ ] é‚®ä»¶æœåŠ¡å¯†é’¥ (å¦‚å¯ç”¨)

4. **æ•°æ®åº“å‡†å¤‡**
   ```bash
   # è¿è¡Œè¿ç§»
   npm run db:migrate
   
   # æ£€æŸ¥è¿ç§»çŠ¶æ€
   npm run db:studio
   ```

### ä¸­ä¼˜å…ˆçº§ (å»ºè®®å®Œæˆ)

5. **æ€§èƒ½æµ‹è¯•**
   ```bash
   # ç”Ÿäº§æ„å»º
   npm run build
   
   # æ£€æŸ¥æ„å»ºå¤§å°
   npm run analyze
   ```

6. **å®‰å…¨æ‰«æ**
   ```bash
   # æ£€æŸ¥å®‰å…¨æ¼æ´
   npm audit
   
   # ä¿®å¤å¯ä¿®å¤çš„æ¼æ´
   npm audit fix
   ```

7. **ç±»å‹æ£€æŸ¥**
   ```bash
   npm run type-check
   ```

### ä½ä¼˜å…ˆçº§ (å¯é€‰)

8. **æ›´æ–°ä¾èµ–åŒ…**
   ```bash
   npm update
   ```

9. **é…ç½®CDN**
   - é™æ€èµ„æºCDNé…ç½®
   - å›¾ç‰‡CDNé…ç½®

10. **SEOä¼˜åŒ–**
    - Metaæ ‡ç­¾æ£€æŸ¥
    - Open Graphé…ç½®
    - ç»“æ„åŒ–æ•°æ®

---

## ğŸŒ éƒ¨ç½²å¹³å°ç‰¹å®šé…ç½®

### Vercel éƒ¨ç½²

```bash
# 1. å®‰è£…Vercel CLI
npm i -g vercel

# 2. é“¾æ¥é¡¹ç›®
vercel link

# 3. è®¾ç½®ç¯å¢ƒå˜é‡
vercel env pull .env.production

# 4. éƒ¨ç½²
vercel --prod
```

**Vercelç¯å¢ƒå˜é‡è®¾ç½®**:
- åœ¨Vercel Dashboardè®¾ç½®æ‰€æœ‰ç”Ÿäº§ç¯å¢ƒå˜é‡
- ç¡®ä¿æ•°æ®åº“å¯ä»Vercelè®¿é—®
- é…ç½®åŸŸåå’ŒSSLè¯ä¹¦

### å…¶ä»–å¹³å° (Docker)

```bash
# 1. æ„å»ºDockeré•œåƒ
docker build -t qiflow-ai .

# 2. è¿è¡Œå®¹å™¨
docker run -p 3000:3000 --env-file .env.production qiflow-ai
```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

### é¢„æœŸæŒ‡æ ‡
- **é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)**: < 1.8s
- **æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP)**: < 2.5s
- **é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)**: < 100ms
- **ç´¯ç§¯å¸ƒå±€åç§» (CLS)**: < 0.1

### æ„å»ºå¤§å°ç›®æ ‡
- First Load JS: < 200KB
- æ€»åŒ…å¤§å°: < 1MB

---

## âœ… éƒ¨ç½²åéªŒè¯æ¸…å•

éƒ¨ç½²å®Œæˆåï¼ŒéªŒè¯ä»¥ä¸‹åŠŸèƒ½ï¼š

### åŸºç¡€åŠŸèƒ½
- [ ] é¦–é¡µæ­£å¸¸åŠ è½½
- [ ] å›½é™…åŒ–è·¯ç”±å·¥ä½œæ­£å¸¸ (/en, /zh-CN)
- [ ] é™æ€èµ„æºæ­£å¸¸åŠ è½½
- [ ] å›¾ç‰‡ä¼˜åŒ–ç”Ÿæ•ˆ

### è®¤è¯æµç¨‹
- [ ] ç”¨æˆ·æ³¨å†Œ
- [ ] ç”¨æˆ·ç™»å½•
- [ ] å¯†ç é‡ç½®
- [ ] ä¼šè¯ç®¡ç†

### APIåŠŸèƒ½
- [ ] APIè·¯ç”±æ­£å¸¸å“åº”
- [ ] é”™è¯¯å¤„ç†å·¥ä½œæ­£å¸¸
- [ ] æƒé™éªŒè¯æœ‰æ•ˆ

### ç›‘æ§å’Œæ—¥å¿—
- [ ] Sentryæ•è·é”™è¯¯
- [ ] æ€§èƒ½ç›‘æ§æ•°æ®
- [ ] åˆ†æè¿½è¸ªæ­£å¸¸

### SEO
- [ ] robots.txtå¯è®¿é—®
- [ ] sitemap.xmlå¯è®¿é—®
- [ ] Metaæ ‡ç­¾æ­£ç¡®
- [ ] Open Graphæ ‡ç­¾æ­£ç¡®

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**1. ç¯å¢ƒå˜é‡æœªåŠ è½½**
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
node -e "console.log(process.env.DATABASE_URL)"

# ç¡®ä¿æ–‡ä»¶åæ­£ç¡®
ls -la .env.production
```

**2. æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
npm run db:studio

# æ£€æŸ¥DATABASE_URLæ ¼å¼
# postgresql://user:password@host:5432/database
```

**3. æ„å»ºå¤±è´¥**
```bash
# æ¸…é™¤ç¼“å­˜é‡æ–°æ„å»º
rm -rf .next
npm run build
```

**4. å›¾ç‰‡åŠ è½½å¤±è´¥**
- æ£€æŸ¥ `next.config.ts` ä¸­çš„ `remotePatterns`
- ç¡®ä¿åŸŸååœ¨ç™½åå•ä¸­

---

## ğŸ“ æ”¯æŒè”ç³»

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é¡¹ç›®æ–‡æ¡£: `/docs`
2. ç¯å¢ƒé…ç½®: `.env.production.example`
3. Sentryé…ç½®: `SENTRY_SETUP.md`

---

## ğŸ“ ç‰ˆæœ¬å†å²

- **v0.1.0** (2025-10-18): åˆå§‹éƒ¨ç½²å‰æ£€æŸ¥
  - å®Œæˆä»£ç å®¡æŸ¥å’Œä¼˜åŒ–
  - åˆ›å»ºSEOé…ç½®æ–‡ä»¶
  - å‡†å¤‡Sentryé…ç½®æŒ‡å—

---

**æœ€åæ›´æ–°**: 2025-10-18  
**ä¸‹æ¬¡æ£€æŸ¥**: éƒ¨ç½²å24å°æ—¶å†…

**éƒ¨ç½²å‡†å¤‡åº¦**: 85% âœ…

éœ€è¦å®ŒæˆSentryé…ç½®åå³å¯éƒ¨ç½²ï¼
