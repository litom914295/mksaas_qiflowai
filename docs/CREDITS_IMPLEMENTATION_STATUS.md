# ç§¯åˆ†ç³»ç»Ÿå®æ–½è¿›åº¦æŠ¥å‘Š

## ğŸ“Š å®Œæˆåº¦æ¦‚è§ˆ

**æ€»è¿›åº¦**: 4/12 (33%)  
**é«˜ä¼˜å…ˆçº§**: âœ… 100% (4/4)  
**ä¸­ä¼˜å…ˆçº§**: ğŸ”„ 0% (0/4)  
**ä½ä¼˜å…ˆçº§**: ğŸ”„ 0% (0/4)

---

## âœ… å·²å®ŒæˆåŠŸèƒ½ (é«˜ä¼˜å…ˆçº§)

### 1. APIæƒé™éªŒè¯ä¸­é—´ä»¶ âœ…
**çŠ¶æ€**: å·²å®Œæˆ  
**æ–‡ä»¶**:
- `src/lib/middleware/adminAuth.ts` (å·²å­˜åœ¨)
- æ‰€æœ‰ç§¯åˆ†APIå·²æ·»åŠ  `withAdminAuth` åŒ…è£…

**åŠŸèƒ½**:
- âœ… ç®¡ç†å‘˜è§’è‰²éªŒè¯
- âœ… ä¼šè¯éªŒè¯
- âœ… æ“ä½œæ—¥å¿—è®°å½•
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†

### 2. ç­¾åˆ°åŠŸèƒ½å®Œæ•´æµç¨‹ âœ…
**çŠ¶æ€**: å·²å®Œæˆ  
**æ–‡ä»¶**:
- `src/app/api/user/checkin/route.ts`

**åŠŸèƒ½**:
- âœ… ç”¨æˆ·ç­¾åˆ°API (POST /api/user/checkin)
- âœ… ç­¾åˆ°çŠ¶æ€æŸ¥è¯¢ (GET /api/user/checkin)
- âœ… è¿ç»­ç­¾åˆ°å¤©æ•°è®¡ç®—
- âœ… é‡Œç¨‹ç¢‘å¥–åŠ±(7å¤©/30å¤©)
- âœ… ç§¯åˆ†è‡ªåŠ¨å‘æ”¾
- âœ… äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// ç­¾åˆ°
POST /api/user/checkin
Response: {
  success: true,
  data: {
    consecutiveDays: 7,
    reward: 7, // 2 + 5(è¿ç»­7å¤©å¥–åŠ±)
    checkInDate: "2025-10-19"
  }
}

// æŸ¥è¯¢çŠ¶æ€
GET /api/user/checkin
Response: {
  hasCheckedInToday: true,
  consecutiveDays: 7,
  thisMonthCheckIns: 15
}
```

### 3. æ¨èåŠŸèƒ½æ¿€æ´»é€»è¾‘ âœ…
**çŠ¶æ€**: å·²å®Œæˆ  
**æ–‡ä»¶**:
- `src/lib/services/referral.ts`
- `src/app/api/user/referral/route.ts`

**åŠŸèƒ½**:
- âœ… æ¨èå…³ç³»åˆ›å»º
- âœ… æ¨èç ç”Ÿæˆ(6ä½)
- âœ… æ¿€æ´»å¥–åŠ±å‘æ”¾
- âœ… æ¨èäººé‡Œç¨‹ç¢‘æ£€æŸ¥(3/10/50äºº)
- âœ… åŒæ–¹å¥–åŠ±å‘æ”¾

**å¥–åŠ±è§„åˆ™**:
- æ¨èäºº: 50ç§¯åˆ†/äºº
- è¢«æ¨èäºº: 20ç§¯åˆ†
- é‡Œç¨‹ç¢‘: 3äºº(100), 10äºº(500), 50äºº(2000)

**é›†æˆç‚¹**:
```typescript
// åœ¨ç”¨æˆ·é¦–æ¬¡å®Œæˆåˆ†ææ—¶è°ƒç”¨
import { activateReferralReward } from '@/lib/services/referral';
await activateReferralReward(userId);
```

### 4. é…ç½®æŒä¹…åŒ–åˆ°æ•°æ®åº“ âœ…
**çŠ¶æ€**: å·²å®Œæˆ  
**æ–‡ä»¶**:
- `prisma/schema.prisma` (æ·»åŠ  CreditConfig æ¨¡å‹)
- `src/lib/services/credit-config.ts`
- `src/app/api/admin/growth/config/credits/route.ts` (å·²æ›´æ–°)

**æ•°æ®åº“è¡¨**:
```sql
CREATE TABLE credit_configs (
  id VARCHAR(36) PRIMARY KEY,
  key VARCHAR(100) UNIQUE,
  value JSON,
  description TEXT,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

**é…ç½®é¡¹**:
- `signin`: ç­¾åˆ°å¥–åŠ±é…ç½®
- `milestones`: é‡Œç¨‹ç¢‘å¥–åŠ±
- `tasks`: ä»»åŠ¡å¥–åŠ±
- `referral`: æ¨èå¥–åŠ±

---

## ğŸ”„ æœªå®ŒæˆåŠŸèƒ½

### ä¸­ä¼˜å…ˆçº§ (0/4)

#### 5. ç§¯åˆ†å…‘æ¢å•†åŸ â³
**é¢„è®¡å·¥æ—¶**: 4å°æ—¶  
**éœ€è¦åˆ›å»º**:
- å•†å“ç®¡ç†API
- å…‘æ¢API
- åº“å­˜ç®¡ç†
- å‰ç«¯å…‘æ¢é¡µé¢

**æ•°æ®åº“è¡¨**: âœ… å·²æ·»åŠ åˆ°schema
- `credit_rewards` (å•†å“è¡¨)
- `credit_redemptions` (å…‘æ¢è®°å½•)

#### 6. æ¨èæ’è¡Œæ¦œ â³
**é¢„è®¡å·¥æ—¶**: 2å°æ—¶  
**éœ€è¦åˆ›å»º**:
- æ’è¡Œæ¦œæ›´æ–°å®šæ—¶ä»»åŠ¡
- æ’è¡Œæ¦œæŸ¥è¯¢API
- å‰ç«¯å±•ç¤ºç»„ä»¶

**æ•°æ®åº“è¡¨**: âœ… å·²å­˜åœ¨
- `leaderboard`

#### 7. æ•°æ®å¯è§†åŒ–å›¾è¡¨ â³
**é¢„è®¡å·¥æ—¶**: 3å°æ—¶  
**éœ€è¦åˆ›å»º**:
- æ•°æ®èšåˆAPI
- Rechartså›¾è¡¨ç»„ä»¶
- ç®¡ç†åå°é›†æˆ

**å›¾è¡¨ç±»å‹**:
- ç§¯åˆ†è¶‹åŠ¿å›¾(æŠ˜çº¿å›¾)
- äº¤æ˜“ç±»å‹åˆ†å¸ƒ(é¥¼å›¾)
- ç”¨æˆ·å¢é•¿æ›²çº¿(é¢ç§¯å›¾)

#### 8. å¼‚å¸¸æ£€æµ‹å’Œå‘Šè­¦ â³
**é¢„è®¡å·¥æ—¶**: 3å°æ—¶  
**éœ€è¦åˆ›å»º**:
- å¼‚å¸¸æ£€æµ‹è§„åˆ™å¼•æ“
- å‘Šè­¦é€šçŸ¥æœåŠ¡
- ç®¡ç†å‘˜å‘Šè­¦é¢æ¿

**æ£€æµ‹è§„åˆ™**:
- å•ç”¨æˆ·æ—¥è·å– > 500ç§¯åˆ†
- IPåœ°å€å¼‚å¸¸æ´»è·ƒ
- çŸ­æ—¶é—´å¤§é‡äº¤æ˜“

### ä½ä¼˜å…ˆçº§ (0/4)

#### 9. ç§¯åˆ†è¿‡æœŸæœºåˆ¶ â³
**é¢„è®¡å·¥æ—¶**: 2å°æ—¶  
**éœ€è¦å®ç°**:
- åœ¨ CreditTransaction æ·»åŠ  expiresAt å­—æ®µ
- å®šæ—¶ä»»åŠ¡æ‰«æè¿‡æœŸç§¯åˆ†
- è¿‡æœŸæ‰£é™¤é€»è¾‘

#### 10. ç§¯åˆ†ç­‰çº§ä½“ç³» â³
**é¢„è®¡å·¥æ—¶**: 3å°æ—¶  
**æ•°æ®åº“è¡¨**: âœ… å·²æ·»åŠ 
- `credit_levels`

**éœ€è¦å®ç°**:
- ç­‰çº§è®¡ç®—é€»è¾‘
- æƒç›Šå·®å¼‚åŒ–
- å‰ç«¯ç­‰çº§å±•ç¤º

#### 11. ç§¯åˆ†è½¬è´¦åŠŸèƒ½ â³
**é¢„è®¡å·¥æ—¶**: 2å°æ—¶  
**éœ€è¦å®ç°**:
- è½¬è´¦API
- æ¯æ—¥é™é¢æ§åˆ¶
- æ‰‹ç»­è´¹æœºåˆ¶
- è½¬è´¦è®°å½•

#### 12. è‡ªåŠ¨åŒ–è¥é”€æ´»åŠ¨ â³
**é¢„è®¡å·¥æ—¶**: 4å°æ—¶  
**éœ€è¦å®ç°**:
- å®šæ—¶ä»»åŠ¡è°ƒåº¦
- èŠ‚æ—¥å¥–åŠ±è§„åˆ™
- ç”Ÿæ—¥å¥–åŠ±
- æ´»åŠ¨é…ç½®ç•Œé¢

---

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ app/api/
â”‚   â”œâ”€â”€ admin/growth/
â”‚   â”‚   â”œâ”€â”€ credits/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts                    âœ… å·²å®Œæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ transactions/route.ts       âœ… å·²å®Œæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ users/route.ts              âœ… å·²å®Œæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ adjust/route.ts             âœ… å·²å®Œæˆ
â”‚   â”‚   â”‚   â””â”€â”€ export/route.ts             âœ… å·²å®Œæˆ
â”‚   â”‚   â””â”€â”€ config/credits/route.ts         âœ… å·²å®Œæˆ
â”‚   â””â”€â”€ user/
â”‚       â”œâ”€â”€ checkin/route.ts                âœ… å·²å®Œæˆ
â”‚       â””â”€â”€ referral/route.ts               âœ… å·²å®Œæˆ
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ prisma.ts                          âœ… å·²å®Œæˆ
â”‚   â”œâ”€â”€ middleware/adminAuth.ts            âœ… å·²å­˜åœ¨
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ referral.ts                    âœ… å·²å®Œæˆ
â”‚       â””â”€â”€ credit-config.ts               âœ… å·²å®Œæˆ
â””â”€â”€ components/
    â””â”€â”€ admin/credits/                      âœ… å‰ç«¯å·²å­˜åœ¨

prisma/
â””â”€â”€ schema.prisma                          âœ… å·²æ›´æ–°

docs/
â”œâ”€â”€ features/credits-system.md             âœ… å·²å®Œæˆ
â””â”€â”€ guides/credits-quickstart.md           âœ… å·²å®Œæˆ
```

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯ç”¨
å½“å‰å·²å®Œæˆçš„åŠŸèƒ½å¯ä»¥ç«‹å³æŠ•å…¥ä½¿ç”¨:
1. è¿è¡Œ `npx prisma migrate dev` åº”ç”¨æ•°æ®åº“è¿ç§»
2. è¿è¡Œ `npx prisma generate` ç”ŸæˆPrisma Client
3. è®¿é—®ç®¡ç†åå°é…ç½®ç§¯åˆ†è§„åˆ™
4. ç”¨æˆ·å¯ä»¥å¼€å§‹ç­¾åˆ°å’Œæ¨è

### å¿«é€Ÿå®æ–½å»ºè®®
æŒ‰ä»¥ä¸‹é¡ºåºå®Œæˆå‰©ä½™åŠŸèƒ½:
1. **ç§¯åˆ†å…‘æ¢å•†åŸ** (æœ€é«˜ä»·å€¼)
2. **æ¨èæ’è¡Œæ¦œ** (å¢åŠ å‚ä¸åº¦)
3. **æ•°æ®å¯è§†åŒ–** (æå‡ç®¡ç†ä½“éªŒ)
4. **ç§¯åˆ†ç­‰çº§ä½“ç³»** (é•¿æœŸæ¿€åŠ±)

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### ç”¨æˆ·ç«¯é›†æˆ
åœ¨é€‚å½“ä½ç½®æ·»åŠ ä»¥ä¸‹è°ƒç”¨:

1. **æ³¨å†Œå®Œæˆå**:
```typescript
// æ£€æŸ¥æ¨èç å¹¶åˆ›å»ºå…³ç³»
if (referralCode) {
  const referrer = await findReferrerByCode(referralCode);
  if (referrer) {
    await createReferral(referrer.id, newUser.id);
  }
}
```

2. **é¦–æ¬¡åˆ†æå®Œæˆå**:
```typescript
// æ¿€æ´»æ¨èå¥–åŠ±
await activateReferralReward(userId);
```

3. **æ¯æ—¥ç™»å½•æ—¶**:
```typescript
// æç¤ºç­¾åˆ°
if (!hasCheckedInToday) {
  showCheckInPrompt();
}
```

### ç®¡ç†å‘˜ä½¿ç”¨
1. è®¿é—® `/zh-CN/admin/operations/growth/credits`
2. æŸ¥çœ‹å®æ—¶æ•°æ®ç»Ÿè®¡
3. è°ƒæ•´å¥–åŠ±é…ç½®
4. æ‰‹åŠ¨è°ƒæ•´ç”¨æˆ·ç§¯åˆ†
5. å¯¼å‡ºæ•°æ®è¿›è¡Œåˆ†æ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¿ç§»**: å¿…é¡»å…ˆæ‰§è¡Œ Prismaè¿ç§»æ‰èƒ½ä½¿ç”¨æ–°åŠŸèƒ½
2. **è®¤è¯ä¾èµ–**: ç¡®ä¿ `@/lib/auth` çš„ `auth()` å‡½æ•°å¯ç”¨
3. **ç¯å¢ƒå˜é‡**: éœ€è¦é…ç½® `NEXT_PUBLIC_APP_URL`
4. **æ€§èƒ½ä¼˜åŒ–**: å¤§é‡ç”¨æˆ·æ—¶éœ€è¦æ·»åŠ ç´¢å¼•ä¼˜åŒ–
5. **å®‰å…¨æ€§**: æ‰€æœ‰ç®¡ç†APIå·²æ·»åŠ æƒé™éªŒè¯

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- åŠŸèƒ½æ–‡æ¡£: `docs/features/credits-system.md`
- å¿«é€ŸæŒ‡å—: `docs/guides/credits-quickstart.md`
- APIå‚è€ƒ: æŸ¥çœ‹å„è·¯ç”±æ–‡ä»¶çš„æ³¨é‡Š
- é—®é¢˜åé¦ˆ: GitHub Issues

---

**æ›´æ–°æ—¶é—´**: 2025-10-19  
**ç‰ˆæœ¬**: v1.0.0  
**çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ,å¯æŠ•å…¥ç”Ÿäº§ä½¿ç”¨
