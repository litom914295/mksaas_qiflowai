# 风水功能测试用例

## 测试环境要求
- 开发服务器运行中 (`npm run dev`)
- 已登录系统
- 配置了AI密钥（DEEPSEEK_API_KEY等）

## 测试用例

### 1. 初次询问风水问题（无房屋信息）

**输入：**
```
那我的房屋应该怎么布置才能更加有利于我的财运呢？
```

**预期响应：**
```
为了准确进行风水分析，我需要您的房屋信息：

请提供以下信息：
1. 房屋朝向（如：坐北朝南、朝东南等）
2. 具体度数（可选，如：朝向120度）
3. 建造年份（可选）
4. 房屋地址（可选）

例如：「我的房子坐北朝南，2010年建造」
或者：「朝向东南120度」
```

### 2. 提供房屋信息

**输入：**
```
我的房子坐北朝南，2010年建造
```

**预期响应：**
```
已识别您的房屋信息并完成风水分析：

🏠 房屋朝向：坐北朝南
📅 建造年份：2010年

**九宫飞星分析**
房屋坐子朝午，属于坎宫。
当前为9运，主要吉位：
• 财位：东北方（八白财星）
• 文昌位：东南方（四绿文昌星）
• 贵人位：西北方（六白武曲星）

需要注意的位置：
• 五黄位：中宫（避免布置重要物品）
• 二黑位：西南方（注意健康问题）

现在您可以询问任何关于风水的问题，比如：
• 哪个方位是财位？
• 卧室应该安排在哪里？
• 如何布置能增强财运？
• 有什么风水禁忌需要注意？
```

### 3. 基于房屋信息询问具体问题

**输入：**
```
你能使用玄空风水的九宫飞星盘帮我布置房子吗？
```

**预期响应（有房屋信息）：**
```
根据您房屋的九宫飞星分析，为您提供详细布置建议：

**财运布局（东北方-八白财星）**
✅ 重点布置区域
• 可设置为客厅或办公区
• 摆放聚宝盆、水晶球等招财物
• 使用黄色、金色装饰增强财气
• 保持明亮通风，气流通畅

**文昌位（东南方-四绿文昌星）**
📚 最佳学习区域
• 适合设置书房或儿童房
• 摆放文昌塔、毛笔等助学物品
• 使用绿色、青色装饰
• 保持整洁有序

**贵人位（西北方-六白武曲星）**
🌟 事业发展区
• 可设置为主卧或办公室
• 摆放金属装饰品
• 使用白色、银色主题

**需要化解的区域**
⚠️ 五黄煞（中宫）
• 避免长时间停留
• 可放置金属风铃化解
• 不宜作为卧室或办公室

⚠️ 二黑病符（西南方）
• 注意健康隐患
• 可放置葫芦化解
• 避免设置为老人房

**颜色建议**
• 整体以暖色调为主
• 财位用黄金色系
• 文昌位用绿色系
• 避免过多黑色、深蓝色

这样的布局能够最大化利用吉位能量，化解凶位影响，有助于提升整体运势。
```

### 4. 结合八字和风水的综合分析

**前置条件：** 已有八字数据（如之前提供的1973年1月7日2点30分男性）

**输入：**
```
根据我的八字和房屋风水，如何布置能最大化我的财运？
```

**预期响应：**
```
根据您的八字命理和房屋风水综合分析：

**命理特点**
您是癸水日主，五行水势极旺（49%），火元素明显不足。
需要加强火元素来平衡命局，提升财运。

**个性化风水布局建议**

🔥 **南方离宫（火位）- 最重要**
您的用神方位，必须重点强化：
• 使用大量红色、紫色装饰
• 安装暖色灯光，增加照明
• 可设置为客厅或活动区
• 摆放电器、灯具增强火气

💰 **东北方艮宫（财位）**
八白财星位置，特别利于您：
• 结合火元素装饰（红色聚宝盆）
• 放置红色水晶或紫晶洞
• 保持明亮，多用暖光灯
• 可摆放发财树配红色装饰

🛏️ **卧室布置建议**
• 床头朝南最佳（补火）
• 使用红色、紫色床品
• 避免北方（水位过旺）
• 东南方次选（木生火）

🎨 **色彩搭配方案**
• 主色调：红色、紫色、橙色（补火）
• 辅助色：绿色（木生火）
• 避免：黑色、深蓝色（水色）
• 适度：白色、金色（已足够）

💡 **特别提醒**
1. 厨房是天然火位，保持使用频率
2. 多使用暖光照明，避免冷光
3. 北方水位不宜久留，避免设卧室
4. 定期使用香薰、蜡烛增加火元素

这样的布局充分考虑了您八字缺火的特点，结合九宫飞星的吉凶方位，能够最大化提升您的财运和整体运势。
```

### 5. 混合输入（房屋信息+问题）

**输入：**
```
我的房子朝东南120度，如何布置客厅能招财？
```

**预期响应：**
```
已识别您的房屋朝向（东南120度），为您分析客厅招财布局：

**房屋风水分析**
• 朝向：东南120度
• 所属：巽宫
• 特点：文昌位，利文职财运

**客厅招财布局方案**

💰 **财位布置（东北角）**
这是八白财星方位，客厅的聚财点：
• 摆放聚宝盆或招财猫
• 放置常绿植物（发财树、金钱树）
• 安装明亮的灯光
• 保持整洁，不堆杂物

🌟 **沙发摆放**
• 背靠实墙，面向大门
• 避免背对门窗
• 形成"聚气"格局
• 利于守财聚财

💡 **灯光设计**
• 主灯明亮圆润
• 财位加装射灯
• 使用暖黄光源
• 避免昏暗角落

🖼️ **装饰建议**
• 挂山水画（山管人丁水管财）
• 摆放金色、黄色装饰品
• 使用圆形、方形物品
• 避免尖锐、破损物品

🪴 **植物摆放**
• 东南角：富贵竹（提升文昌运）
• 东北角：发财树（增强财运）
• 避免带刺植物
• 定期修剪枯叶

**注意事项**
• 保持空气流通
• 定期清洁打扫
• 避免横梁压顶
• 不对镜子正对大门

这样布置能够充分利用您房屋的文昌优势，配合财星方位，有效提升财运。
```

## 测试命令

### PowerShell测试脚本
```powershell
# 测试风水功能
$API_URL = "http://localhost:3000/api/qiflow/chat"

# 测试1: 询问风水问题
$body1 = @{
    message = "如何用玄空风水布置我的房子？"
    context = @{}
} | ConvertTo-Json

Invoke-WebRequest -Uri $API_URL -Method POST -Body $body1 -ContentType "application/json"

# 测试2: 提供房屋信息
$body2 = @{
    message = "我的房子坐北朝南，2010年建造"
    context = @{}
} | ConvertTo-Json

Invoke-WebRequest -Uri $API_URL -Method POST -Body $body2 -ContentType "application/json"

# 测试3: 基于房屋信息询问
$body3 = @{
    message = "哪个方位是财位？"
    context = @{
        houseInfo = @{
            facing = "坐北朝南"
            buildYear = 2010
        }
        calculatedFengshui = @{
            # 风水计算结果
        }
    }
} | ConvertTo-Json -Depth 10

Invoke-WebRequest -Uri $API_URL -Method POST -Body $body3 -ContentType "application/json"
```

## 预期效果

1. **智能识别**：自动识别用户询问的风水相关问题
2. **信息收集**：缺少房屋信息时友好引导提供
3. **算法计算**：使用九宫飞星算法计算风水布局
4. **个性化建议**：结合用户八字提供定制化建议
5. **专业回答**：基于算法数据提供准确的风水指导

## 注意事项

1. 确保已配置AI密钥（至少一个）：
   - DEEPSEEK_API_KEY
   - OPENAI_API_KEY
   - GOOGLE_API_KEY

2. 开发服务器必须运行中

3. 需要登录状态才能调用API

4. 如果同时有八字数据，会提供更个性化的综合建议