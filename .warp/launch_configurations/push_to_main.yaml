name: "ğŸš€ Push to Main"
description: "Commit all changes and push to main branch with verification"
icon: "git-merge"
category: "Git Operations"
tags:
  - git
  - deploy
  - main
  - push

# é…ç½®å¿«æ·é”®ï¼ˆå¯é€‰ï¼‰
hotkey: "ctrl+shift+p"

# å·¥ä½œæµé…ç½®
workflow:
  # ä½¿ç”¨çš„è„šæœ¬æ–‡ä»¶
  script: ".warp/workflows/push.ps1"
  
  # è¿è¡Œæ—¶ç¯å¢ƒ
  shell: "powershell"
  
  # æ˜¯å¦åœ¨æ–°ç»ˆç«¯çª—å£ä¸­è¿è¡Œ
  new_terminal: false
  
  # æ˜¯å¦éœ€è¦ç¡®è®¤
  requires_confirmation: true
  
  # ç¡®è®¤æç¤ºä¿¡æ¯
  confirmation_message: "This will commit and push all changes to the main branch. Continue?"

# å‚æ•°é…ç½®
parameters:
  - name: "message"
    type: "string"
    label: "Commit Message"
    description: "Enter commit message"
    default: "feat: update code"
    required: true
    prompt: true

# ç¯å¢ƒæ£€æŸ¥
pre_checks:
  - type: "file_exists"
    path: ".git"
    error_message: "Not a git repository"
  
  - type: "command_available"
    command: "git"
    error_message: "Git is not installed"

# æ‰§è¡Œæ­¥éª¤
steps:
  - name: "Run Push Workflow"
    command: |
      $message = Read-Host -Prompt "Enter commit message (or press Enter for default)"
      if ([string]::IsNullOrWhiteSpace($message)) {
        $message = "feat: update code"
      }
      & .\.warp\workflows\push.ps1 -Message $message

# æˆåŠŸåçš„æ“ä½œ
on_success:
  show_notification: true
  notification_title: "Push Successful"
  notification_message: "Changes have been pushed to main branch"
  
# å¤±è´¥åçš„æ“ä½œ  
on_failure:
  show_notification: true
  notification_title: "Push Failed"
  notification_message: "Please check the output for errors"