# @PRD_ADMIN_PANEL_v5.1.1.md

## 文档元信息
- 文档版本：v5.1.1
- 最近更新时间：2025-10-11
- 文档状态：优化完善版
- 产品名称：mksaas_qiflowai 综合管理后台
- 适用场景：单人公司/小团队SaaS运营管理
- 架构模式：单体架构（预留多租户扩展）

## 1. 概述
本文件定义了 mksaas_qiflowai 项目的综合管理后台（以下简称“管理后台”）的用户需求。管理后台面向内部运营、内容、数据及技术团队，提供统一的业务运营与系统配置入口。

## 2. 目标
1. 提供可视化后台，对平台核心资源进行 CRUD 与批量操作。
2. 降低运营及内容人员的技术门槛，提高工作效率。
3. 保障数据安全、权限隔离与可追溯性。
4. 支撑未来新增业务模块的快速接入。

## 3. 术语
| 缩写 | 说明 |
|------|------|
| RSC  | React Server Component |
| RBAC | Role-Based Access Control |
| CMS  | Content Management System |

## 4. 角色与权限
| 角色 | 描述 | 典型权限 |
|------|------|-----------|
| 超级管理员 | 平台最高权限，负责系统配置、账号分配 | 全部权限 |
| 运营经理   | 负责活动配置、订单与财务对账       | 运营管理 + 数据查看 |
| 内容编辑   | 负责文章/课程等内容生产与审核       | 内容管理（含审核流） |
| 数据分析师 | 查看数据报表与导出                 | 数据管理（只读+导出） |
| 客服       | 查询用户信息，处理售后工单         | 用户管理（只读） + 工单处理 |

RBAC 需支持自定义角色与权限粒度（菜单级 & 数据级）。

## 5. 用户故事
1. **用户管理 – 创建用户账号**  
   作为超级管理员，我希望在后台创建新员工账号并分配角色，以便其登录系统后只能操作授权模块。
2. **运营管理 – 配置限时折扣活动**  
   作为运营经理，我需要创建限时折扣并设定生效时间，系统自动生效下架。
3. **数据管理 – 导出日报**  
   作为数据分析师，我要选择日期范围并一键导出 CSV 报表，用于 BI 分析。
4. **内容管理 – 多人协作审核**  
   作为内容编辑，我希望提交的文章需经至少两位编辑审核后才能上线。

## 6. 功能需求
### 6.1 用户管理 (UM)
| 编号 | 功能 | 描述 | 优先级 |
|------|------|------|--------|
| UM-1 | 账户列表 | 列表检索、分页、导出 | P0 |
| UM-2 | 账户创建 | 邮箱/手机号注册，初始化角色 | P0 |
| UM-3 | 角色管理 | 创建/编辑/删除角色，配置权限点 | P0 |
| UM-4 | 登录日志 | 查看登录 IP、时间、状态 | P1 |
| UM-5 | 工单中心 | 工单流转、标签、回复模板 | P1 |

### 6.2 运营管理 (OP)
| 编号 | 功能 | 描述 | 优先级 |
|------|------|------|--------|
| OP-1 | 活动管理 | 限时折扣、满减、优惠券配置 | P0 |
| OP-2 | 订单管理 | 查询、退款、发票导出 | P0 |
| OP-3 | 财务对账 | 订单流水对账、下载凭证 | P1 |
| OP-4 | 推送中心 | 站内信、邮件、短信模板与发送 | P1 |

### 6.3 数据管理 (DA)
| 编号 | 功能 | 描述 | 优先级 |
|------|------|------|--------|
| DA-1 | 数据概览 | DAU、留存、收入、转化漏斗 | P0 |
| DA-2 | 自定义报表 | SQL + 图表可视化，保存模板 | P1 |
| DA-3 | 导出 & API | CSV/Excel 导出，开放 BI API | P1 |

### 6.4 内容管理 (CM)
| 编号 | 功能 | 描述 | 优先级 |
|------|------|------|--------|
| CM-1 | 文章管理 | Markdown 编辑、封面上传、标签 | P0 |
| CM-2 | 分类 & 标签 | 多级分类树、拖拽排序 | P0 |
| CM-3 | 审核流程 | 起草→初审→复审→发布，支持回退 | P0 |
| CM-4 | 资源库 | 图片、文件统一管理，自动压缩 | P1 |

### 6.5 系统设置 (SS)
| 编号 | 功能 | 描述 | 优先级 |
|------|------|------|--------|
| SS-1 | 全局配置 | 站点信息、SEO、隐私政策 | P0 |
| SS-2 | 环境变量 | 安全存储第三方密钥，区分 Env | P0 |
| SS-3 | 审计日志 | 记录所有后台操作，支持导出 | P1 |

## 7. 非功能需求
1. **安全**：基于 RBAC 的最小权限原则；所有接口需鉴权；敏感操作二次确认。
2. **性能**：页面首屏 < 1.5s，P95 接口 < 300ms；报表异步生成。
3. **可用性**：SLA ≥ 99.9%；核心功能降级策略。
4. **可扩展性**：模块化路由；支持微前端拆分。
5. **兼容性**：桌面 Chrome ≥ 109、Edge ≥ 109；移动端只读模式。
6. **本地化**：中英文切换，i18n 文件驱动。

## 8. 数据模型概览
```
用户 User(id, email, phone, password_hash, role_id, status)
角色 Role(id, name, permissions[])
权限 Permission(id, code, desc)
文章 Post(id, title, slug, status, author_id, created_at)
订单 Order(id, user_id, amount, status, paid_at)
活动 Campaign(id, type, config_json, start_at, end_at)
```
详细 ERD 见 @TECH_GUIDE_DB_v5.1.1.md。

## 9. 里程碑
| Milestone | 目标 | 截止日期 |
|-----------|------|----------|
| M1 | 完成 PRD 评审 & 技术选型 | 2025-10-20 |
| M2 | 用户管理 & 登录模块 MVP | 2025-11-05 |
| M3 | 运营管理 & 内容管理 MVP | 2025-11-25 |
| M4 | 数据管理 MVP | 2025-12-10 |
| M5 | 全模块功能完备，进入 Beta | 2025-12-25 |

## 10. 风险与对策
| 风险 | 影响 | 对策 |
|------|------|------|
| 需求蔓延 | 延期 / 资源不足 | 冰箱机制，严格优先级控制 |
| 权限设计过细 | 复杂度上升 | 采用通用权限模板，逐步细化 |
| 报表性能瓶颈 | 用户体验差 | 预聚合 + 缓存，异步导出 |

## 11. 交互 & 视觉
- 组件库：Shadcn UI + Radix UI + Tailwind，保持一致性。
- 前端技术栈：Next.js App Router (RSC 优先)，TypeScript 全面严格模式。
- 响应式布局：支持 1280px 及以上桌面宽度；移动端提供只读关键视图。

## 12. 结语
本 PRD 为管理后台建设的基础输入，后续将基于 TaskMaster 工具拆分具体任务并分配开发、测试、上线流程。请相关干系人于 **2025-10-18** 前完成评审并反馈。
